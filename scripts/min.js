/*


 SoundManager 2: JavaScript Sound for the Web
 ----------------------------------------------
 http://schillmania.com/projects/soundmanager2/

 Copyright (c) 2007, Scott Schiller. All rights reserved.
 Code provided under the BSD License:
 http://schillmania.com/projects/soundmanager2/license.txt

 V2.97a.20120624
*/
(function(e){function a(a,b){function g(a){return c.preferFlash&&F&&!c.ignoreFlash&&"undefined"!==typeof c.flash[a]&&c.flash[a]}function f(a){return function(b){var f=this._t;!f||!f._a?(f&&f.id?c._wD(q+"ignoring "+b.type+": "+f.id):c._wD(q+"ignoring "+b.type),b=null):b=a.call(this,b);return b}}this.setupOptions={url:a||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,
flashLoadTimeout:1E3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!0,noSWFCache:!1};this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100};this.flash9Options=
{isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},
wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}};this.movieID="sm2-container";this.id=b||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20120624";this.altURL=this.movieURL=this.version=null;this.enabled=this.swfLoaded=!1;this.oMC=null;this.sounds={};this.soundIDs=[];this.didFlashBlock=this.muted=!1;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features=
{buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1};this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null};var m;try{m="undefined"!==typeof Audio&&"undefined"!==typeof(new Audio).canPlayType}catch(i){m=!1}this.hasHTML5=m;this.html5={usingFlash:null};
this.flash={};this.ignoreFlash=this.html5Only=!1;var n,c=this,l=null,q="HTML5::",u,s=navigator.userAgent,t=e,A=t.location.href.toString(),p=document,r,L,W,v,I=[],sa=!0,E,X=!1,Y=!1,z=!1,D=!1,ea=!1,w,fb=0,Z,B,ta,N,ua,O,P,Q,Ka,va,fa,ga,ha,R,wa,xa,ia,ja,S,La,ya,gb=["log","info","warn","error"],Ma,ka,Na,aa=null,za=null,x,Aa,T,Oa,la,ma,U,y,ba=!1,Ba=!1,Pa,Qa,Ra,na=0,ca=null,oa,G=null,Sa,pa,da,J,Ca,Da,Ta,C,Ua=Array.prototype.slice,M=!1,F,Ea,Va,H,Wa,Fa=s.match(/(ipad|iphone|ipod)/i),K=s.match(/msie/i),hb=
s.match(/webkit/i),Ga=s.match(/safari/i)&&!s.match(/chrome/i),Xa=s.match(/opera/i),Ha=s.match(/(mobile|pre\/|xoom)/i)||Fa,Ia=!A.match(/usehtml5audio/i)&&!A.match(/sm2\-ignorebadua/i)&&Ga&&!s.match(/silk/i)&&s.match(/OS X 10_6_([3-7])/i),Ya="undefined"!==typeof console&&"undefined"!==typeof console.log,Ja="undefined"!==typeof p.hasFocus?p.hasFocus():null,qa=Ga&&("undefined"===typeof p.hasFocus||!p.hasFocus()),Za=!qa,$a=/(mp3|mp4|mpa|m4a)/i,V=p.location?p.location.protocol.match(/http/i):null,ab=!V?
"http://":"",bb=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|mp4v|3gp|3g2)\s*(?:$|;)/i,cb="mpeg4 aac flv mov mp4 m4v f4v m4a mp4v 3gp 3g2".split(" "),ib=RegExp("\\.("+cb.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!V;this._global_a=null;Ha&&(c.useHTML5Audio=!0,c.preferFlash=!1,Fa&&(M=c.ignoreFlash=!0));this.setup=function(a){typeof a!=="undefined"&&(z&&G&&c.ok()&&(typeof a.flashVersion!=="undefined"||typeof a.url!=="undefined"))&&
U(x("setupLate"));ta(a);return c};this.supported=this.ok=function(){return G?z&&!D:c.useHTML5Audio&&c.hasHTML5};this.getMovie=function(c){return u(c)||p[c]||t[c]};this.createSound=function(a,b){function f(){h=la(h);c.sounds[g.id]=new n(g);c.soundIDs.push(g.id);return c.sounds[g.id]}var d,h=null,g=d=null;d="soundManager.createSound(): "+x(!z?"notReady":"notOK");if(!z||!c.ok()){U(d);return false}typeof b!=="undefined"&&(a={id:a,url:b});h=B(a);h.url=oa(h.url);g=h;g.id.toString().charAt(0).match(/^[0-9]$/)&&
c._wD("soundManager.createSound(): "+x("badID",g.id),2);c._wD("soundManager.createSound(): "+g.id+" ("+g.url+")",1);if(y(g.id,true)){c._wD("soundManager.createSound(): "+g.id+" exists",1);return c.sounds[g.id]}if(pa(g)){d=f();c._wD("Creating sound "+g.id+", using HTML5");d._setup_html5(g)}else{if(v>8){if(g.isMovieStar===null)g.isMovieStar=!(!g.serverURL&&!(g.type&&g.type.match(bb)||g.url.match(ib)));if(g.isMovieStar){c._wD("soundManager.createSound(): using MovieStar handling");g.loops>1&&w("noNSLoop")}}g=
ma(g,"soundManager.createSound(): ");d=f();if(v===8)l._createSound(g.id,g.loops||1,g.usePolicyFile);else{l._createSound(g.id,g.url,g.usePeakData,g.useWaveformData,g.useEQData,g.isMovieStar,g.isMovieStar?g.bufferTime:false,g.loops||1,g.serverURL,g.duration||null,g.autoPlay,true,g.autoLoad,g.usePolicyFile);if(!g.serverURL){d.connected=true;g.onconnect&&g.onconnect.apply(d)}}!g.serverURL&&(g.autoLoad||g.autoPlay)&&d.load(g)}!g.serverURL&&g.autoPlay&&d.play();return d};this.destroySound=function(a,b){if(!y(a))return false;
var f=c.sounds[a],d;f._iO={};f.stop();f.unload();for(d=0;d<c.soundIDs.length;d++)if(c.soundIDs[d]===a){c.soundIDs.splice(d,1);break}b||f.destruct(true);delete c.sounds[a];return true};this.load=function(a,b){return!y(a)?false:c.sounds[a].load(b)};this.unload=function(a){return!y(a)?false:c.sounds[a].unload()};this.onposition=this.onPosition=function(a,b,f,d){return!y(a)?false:c.sounds[a].onposition(b,f,d)};this.clearOnPosition=function(a,b,f){return!y(a)?false:c.sounds[a].clearOnPosition(b,f)};this.start=
this.play=function(a,b){var f=false;if(!z||!c.ok()){U("soundManager.play(): "+x(!z?"notReady":"notOK"));return f}if(!y(a)){b instanceof Object||(b={url:b});if(b&&b.url){c._wD('soundManager.play(): attempting to create "'+a+'"',1);b.id=a;f=c.createSound(b).play()}return f}return c.sounds[a].play(b)};this.setPosition=function(a,b){return!y(a)?false:c.sounds[a].setPosition(b)};this.stop=function(a){if(!y(a))return false;c._wD("soundManager.stop("+a+")",1);return c.sounds[a].stop()};this.stopAll=function(){var a;
c._wD("soundManager.stopAll()",1);for(a in c.sounds)c.sounds.hasOwnProperty(a)&&c.sounds[a].stop()};this.pause=function(a){return!y(a)?false:c.sounds[a].pause()};this.pauseAll=function(){var a;for(a=c.soundIDs.length-1;a>=0;a--)c.sounds[c.soundIDs[a]].pause()};this.resume=function(a){return!y(a)?false:c.sounds[a].resume()};this.resumeAll=function(){var a;for(a=c.soundIDs.length-1;a>=0;a--)c.sounds[c.soundIDs[a]].resume()};this.togglePause=function(a){return!y(a)?false:c.sounds[a].togglePause()};this.setPan=
function(a,b){return!y(a)?false:c.sounds[a].setPan(b)};this.setVolume=function(a,b){return!y(a)?false:c.sounds[a].setVolume(b)};this.mute=function(a){var b=0;typeof a!=="string"&&(a=null);if(a){if(!y(a))return false;c._wD('soundManager.mute(): Muting "'+a+'"');return c.sounds[a].mute()}c._wD("soundManager.mute(): Muting all sounds");for(b=c.soundIDs.length-1;b>=0;b--)c.sounds[c.soundIDs[b]].mute();return c.muted=true};this.muteAll=function(){c.mute()};this.unmute=function(a){typeof a!=="string"&&
(a=null);if(a){if(!y(a))return false;c._wD('soundManager.unmute(): Unmuting "'+a+'"');return c.sounds[a].unmute()}c._wD("soundManager.unmute(): Unmuting all sounds");for(a=c.soundIDs.length-1;a>=0;a--)c.sounds[c.soundIDs[a]].unmute();c.muted=false;return true};this.unmuteAll=function(){c.unmute()};this.toggleMute=function(a){return!y(a)?false:c.sounds[a].toggleMute()};this.getMemoryUse=function(){var c=0;l&&v!==8&&(c=parseInt(l._getMemoryUse(),10));return c};this.disable=function(a){var b;typeof a===
"undefined"&&(a=false);if(D)return false;D=true;w("shutdown",1);for(b=c.soundIDs.length-1;b>=0;b--)Ma(c.sounds[c.soundIDs[b]]);Z(a);C.remove(t,"load",P);return true};this.canPlayMIME=function(a){var b;c.hasHTML5&&(b=da({type:a}));!b&&G&&(b=a&&c.ok()?!!(v>8&&a.match(bb)||a.match(c.mimePattern)):null);return b};this.canPlayURL=function(a){var b;c.hasHTML5&&(b=da({url:a}));!b&&G&&(b=a&&c.ok()?!!a.match(c.filePattern):null);return b};this.canPlayLink=function(a){return typeof a.type!=="undefined"&&a.type&&
c.canPlayMIME(a.type)?true:c.canPlayURL(a.href)};this.getSoundById=function(a,b){if(!a)throw Error("soundManager.getSoundById(): sID is null/undefined");var f=c.sounds[a];!f&&!b&&c._wD('"'+a+'" is an invalid sound ID.',2);return f};this.onready=function(a,b){if(typeof a==="function"){z&&c._wD(x("queue","onready"));b||(b=t);ua("onready",a,b);O()}else throw x("needFunction","onready");return true};this.ontimeout=function(a,b){if(typeof a==="function"){z&&c._wD(x("queue","ontimeout"));b||(b=t);ua("ontimeout",
a,b);O({type:"ontimeout"})}else throw x("needFunction","ontimeout");return true};this._wD=this._writeDebug=function(a,b,f){var d,g;if(!c.debugMode)return false;typeof f!=="undefined"&&f&&(a=a+" | "+(new Date).getTime());if(Ya&&c.useConsole){f=gb[b];if(typeof console[f]!=="undefined")console[f](a);else console.log(a);if(c.consoleOnly)return true}try{d=u("soundmanager-debug");if(!d)return false;g=p.createElement("div");if(++fb%2===0)g.className="sm2-alt";b=typeof b==="undefined"?0:parseInt(b,10);g.appendChild(p.createTextNode(a));
if(b){if(b>=2)g.style.fontWeight="bold";if(b===3)g.style.color="#ff3333"}d.insertBefore(g,d.firstChild)}catch(h){}return true};this._debug=function(){var a,b;w("currentObj",1);a=0;for(b=c.soundIDs.length;a<b;a++)c.sounds[c.soundIDs[a]]._debug()};this.reboot=function(){c._wD("soundManager.reboot()");c.soundIDs.length&&c._wD("Destroying "+c.soundIDs.length+" SMSound objects...");var a,b;for(a=c.soundIDs.length-1;a>=0;a--)c.sounds[c.soundIDs[a]].destruct();if(l)try{if(K)za=l.innerHTML;aa=l.parentNode.removeChild(l);
c._wD("Flash movie removed.")}catch(f){w("badRemove",2)}za=aa=G=null;c.enabled=xa=z=ba=Ba=X=Y=D=c.swfLoaded=false;c.soundIDs=[];c.sounds={};l=null;for(a in I)if(I.hasOwnProperty(a))for(b=I[a].length-1;b>=0;b--)I[a][b].fired=false;c._wD("soundManager: Rebooting...");t.setTimeout(c.beginDelayedInit,20)};this.getMoviePercent=function(){return l&&typeof l.PercentLoaded!=="undefined"?l.PercentLoaded():null};this.beginDelayedInit=function(){ea=true;R();setTimeout(function(){if(Ba)return false;ja();ha();
return Ba=true},20);Q()};this.destruct=function(){c._wD("soundManager.destruct()");c.disable(true)};n=function(a){var b,f,d=this,g,h,i,e,k,n,m=false,u=[],s=0,t,A,p=null;f=b=null;this.sID=this.id=a.id;this.url=a.url;this._iO=this.instanceOptions=this.options=B(a);this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=false;this._a=null;this.id3={};this._debug=function(){if(c.debugMode){var a=null,b=[],o,f;for(a in d.options)if(d.options[a]!==null)if(typeof d.options[a]==="function"){o=
d.options[a].toString();o=o.replace(/\s\s+/g," ");f=o.indexOf("{");b.push(" "+a+": {"+o.substr(f+1,Math.min(Math.max(o.indexOf("\n")-1,64),64)).replace(/\n/g,"")+"... }")}else b.push(" "+a+": "+d.options[a]);c._wD("SMSound() merged options: {\n"+b.join(", \n")+"\n}")}};this._debug();this.load=function(a){var b=null;if(typeof a!=="undefined"){d._iO=B(a,d.options);d.instanceOptions=d._iO}else{a=d.options;d._iO=a;d.instanceOptions=d._iO;if(p&&p!==d.url){w("manURL");d._iO.url=d.url;d.url=null}}if(!d._iO.url)d._iO.url=
d.url;d._iO.url=oa(d._iO.url);c._wD("SMSound.load(): "+d._iO.url,1);if(d._iO.url===d.url&&d.readyState!==0&&d.readyState!==2){w("onURL",1);d.readyState===3&&d._iO.onload&&d._iO.onload.apply(d,[!!d.duration]);return d}a=d._iO;p=d.url;d.loaded=false;d.readyState=1;d.playState=0;d.id3={};if(pa(a)){b=d._setup_html5(a);if(b._called_load)c._wD(q+"ignoring request to load again: "+d.id);else{c._wD(q+"load: "+d.id);d._html5_canplay=false;if(d._a.src!==a.url){c._wD(w("manURL")+": "+a.url);d._a.src=a.url;d.setPosition(0)}d._a.autobuffer=
"auto";d._a.preload="auto";b._called_load=true;a.autoPlay&&d.play()}}else try{d.isHTML5=false;d._iO=ma(la(a));a=d._iO;v===8?l._load(d.id,a.url,a.stream,a.autoPlay,a.whileloading?1:0,a.loops||1,a.usePolicyFile):l._load(d.id,a.url,!!a.stream,!!a.autoPlay,a.loops||1,!!a.autoLoad,a.usePolicyFile)}catch(o){w("smError",2);E("onload",false);S({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:true})}return d};this.unload=function(){if(d.readyState!==0){c._wD('SMSound.unload(): "'+d.id+'"');if(d.isHTML5){e();if(d._a){d._a.pause();
Ca(d._a,"about:blank");d.url="about:blank"}}else v===8?l._unload(d.id,"about:blank"):l._unload(d.id);g()}return d};this.destruct=function(a){c._wD('SMSound.destruct(): "'+d.id+'"');if(d.isHTML5){e();if(d._a){d._a.pause();Ca(d._a);M||i();d._a._t=null;d._a=null}}else{d._iO.onfailure=null;l._destroySound(d.id)}a||c.destroySound(d.id,true)};this.start=this.play=function(a,b){var o,f;f=true;f=null;b=typeof b==="undefined"?true:b;a||(a={});d._iO=B(a,d._iO);d._iO=B(d._iO,d.options);d._iO.url=oa(d._iO.url);
d.instanceOptions=d._iO;if(d._iO.serverURL&&!d.connected){if(!d.getAutoPlay()){c._wD("SMSound.play():  Netstream not connected yet - setting autoPlay");d.setAutoPlay(true)}return d}if(pa(d._iO)){d._setup_html5(d._iO);k()}if(d.playState===1&&!d.paused)if(o=d._iO.multiShot)c._wD('SMSound.play(): "'+d.id+'" already playing (multi-shot)',1);else{c._wD('SMSound.play(): "'+d.id+'" already playing (one-shot)',1);f=d}if(f!==null)return f;if(d.loaded)c._wD('SMSound.play(): "'+d.id+'"');else if(d.readyState===
0){c._wD('SMSound.play(): Attempting to load "'+d.id+'"',1);if(!d.isHTML5)d._iO.autoPlay=true;d.load(d._iO)}else if(d.readyState===2){c._wD('SMSound.play(): Could not load "'+d.id+'" - exiting',2);f=d}else c._wD('SMSound.play(): "'+d.id+'" is loading - attempting to play..',1);if(f!==null)return f;if(!d.isHTML5&&v===9&&d.position>0&&d.position===d.duration){c._wD('SMSound.play(): "'+d.id+'": Sound at end, resetting to position:0');a.position=0}if(d.paused&&d.position&&d.position>0){c._wD('SMSound.play(): "'+
d.id+'" is resuming from paused state',1);d.resume()}else{d._iO=B(a,d._iO);if(d._iO.from!==null&&d._iO.to!==null&&d.instanceCount===0&&d.playState===0&&!d._iO.serverURL){o=function(){d._iO=B(a,d._iO);d.play(d._iO)};if(d.isHTML5&&!d._html5_canplay){c._wD('SMSound.play(): Beginning load of "'+d.id+'" for from/to case');d.load({_oncanplay:o});f=false}else if(!d.isHTML5&&!d.loaded&&(!d.readyState||d.readyState!==2)){c._wD('SMSound.play(): Preloading "'+d.id+'" for from/to case');d.load({onload:o});f=
false}if(f!==null)return f;d._iO=A()}c._wD('SMSound.play(): "'+d.id+'" is starting to play');(!d.instanceCount||d._iO.multiShotEvents||!d.isHTML5&&v>8&&!d.getAutoPlay())&&d.instanceCount++;d._iO.onposition&&d.playState===0&&n(d);d.playState=1;d.paused=false;d.position=typeof d._iO.position!=="undefined"&&!isNaN(d._iO.position)?d._iO.position:0;if(!d.isHTML5)d._iO=ma(la(d._iO));if(d._iO.onplay&&b){d._iO.onplay.apply(d);m=true}d.setVolume(d._iO.volume,true);d.setPan(d._iO.pan,true);if(d.isHTML5){k();
f=d._setup_html5();d.setPosition(d._iO.position);f.play()}else{f=l._start(d.id,d._iO.loops||1,v===9?d._iO.position:d._iO.position/1E3,d._iO.multiShot);if(v===9&&!f){c._wD("SMSound.play(): "+d.id+": No sound hardware, or 32-sound ceiling hit");d._iO.onplayerror&&d._iO.onplayerror.apply(d)}}}return d};this.stop=function(a){var c=d._iO;if(d.playState===1){d._onbufferchange(0);d._resetOnPosition(0);d.paused=false;if(!d.isHTML5)d.playState=0;t();c.to&&d.clearOnPosition(c.to);if(d.isHTML5){if(d._a){a=d.position;
d.setPosition(0);d.position=a;d._a.pause();d.playState=0;d._onTimer();e()}}else{l._stop(d.id,a);c.serverURL&&d.unload()}d.instanceCount=0;d._iO={};c.onstop&&c.onstop.apply(d)}return d};this.setAutoPlay=function(a){c._wD("sound "+d.id+" turned autoplay "+(a?"on":"off"));d._iO.autoPlay=a;if(!d.isHTML5){l._setAutoPlay(d.id,a);if(a&&!d.instanceCount&&d.readyState===1){d.instanceCount++;c._wD("sound "+d.id+" incremented instance count to "+d.instanceCount)}}};this.getAutoPlay=function(){return d._iO.autoPlay};
this.setPosition=function(a){typeof a==="undefined"&&(a=0);var b=d.isHTML5?Math.max(a,0):Math.min(d.duration||d._iO.duration,Math.max(a,0));d.position=b;a=d.position/1E3;d._resetOnPosition(d.position);d._iO.position=b;if(d.isHTML5){if(d._a)if(d._html5_canplay){if(d._a.currentTime!==a){c._wD("setPosition("+a+"): setting position");try{d._a.currentTime=a;(d.playState===0||d.paused)&&d._a.pause()}catch(o){c._wD("setPosition("+a+"): setting position failed: "+o.message,2)}}}else c._wD("setPosition("+
a+"): delaying, sound not ready")}else{a=v===9?d.position:a;d.readyState&&d.readyState!==2&&l._setPosition(d.id,a,d.paused||!d.playState,d._iO.multiShot)}d.isHTML5&&d.paused&&d._onTimer(true);return d};this.pause=function(a){if(d.paused||d.playState===0&&d.readyState!==1)return d;c._wD("SMSound.pause()");d.paused=true;if(d.isHTML5){d._setup_html5().pause();e()}else(a||typeof a==="undefined")&&l._pause(d.id,d._iO.multiShot);d._iO.onpause&&d._iO.onpause.apply(d);return d};this.resume=function(){var a=
d._iO;if(!d.paused)return d;c._wD("SMSound.resume()");d.paused=false;d.playState=1;if(d.isHTML5){d._setup_html5().play();k()}else{a.isMovieStar&&!a.serverURL&&d.setPosition(d.position);l._pause(d.id,a.multiShot)}if(!m&&a.onplay){a.onplay.apply(d);m=true}else a.onresume&&a.onresume.apply(d);return d};this.togglePause=function(){c._wD("SMSound.togglePause()");if(d.playState===0){d.play({position:v===9&&!d.isHTML5?d.position:d.position/1E3});return d}d.paused?d.resume():d.pause();return d};this.setPan=
function(a,c){typeof a==="undefined"&&(a=0);typeof c==="undefined"&&(c=false);d.isHTML5||l._setPan(d.id,a);d._iO.pan=a;if(!c){d.pan=a;d.options.pan=a}return d};this.setVolume=function(a,b){typeof a==="undefined"&&(a=100);typeof b==="undefined"&&(b=false);if(d.isHTML5){if(d._a)d._a.volume=Math.max(0,Math.min(1,a/100))}else l._setVolume(d.id,c.muted&&!d.muted||d.muted?0:a);d._iO.volume=a;if(!b){d.volume=a;d.options.volume=a}return d};this.mute=function(){d.muted=true;if(d.isHTML5){if(d._a)d._a.muted=
true}else l._setVolume(d.id,0);return d};this.unmute=function(){d.muted=false;var a=typeof d._iO.volume!=="undefined";if(d.isHTML5){if(d._a)d._a.muted=false}else l._setVolume(d.id,a?d._iO.volume:d.options.volume);return d};this.toggleMute=function(){return d.muted?d.unmute():d.mute()};this.onposition=this.onPosition=function(a,c,b){u.push({position:parseInt(a,10),method:c,scope:typeof b!=="undefined"?b:d,fired:false});return d};this.clearOnPosition=function(a,c){var d,a=parseInt(a,10);if(isNaN(a))return false;
for(d=0;d<u.length;d++)if(a===u[d].position&&(!c||c===u[d].method)){u[d].fired&&s--;u.splice(d,1)}};this._processOnPosition=function(){var a,c;a=u.length;if(!a||!d.playState||s>=a)return false;for(a=a-1;a>=0;a--){c=u[a];if(!c.fired&&d.position>=c.position){c.fired=true;s++;c.method.apply(c.scope,[c.position])}}return true};this._resetOnPosition=function(a){var c,d;c=u.length;if(!c)return false;for(c=c-1;c>=0;c--){d=u[c];if(d.fired&&a<=d.position){d.fired=false;s--}}return true};A=function(){var a=
d._iO,b=a.from,o=a.to,f,g;g=function(){c._wD(d.id+': "to" time of '+o+" reached.");d.clearOnPosition(o,g);d.stop()};f=function(){c._wD(d.id+': playing "from" '+b);if(o!==null&&!isNaN(o))d.onPosition(o,g)};if(b!==null&&!isNaN(b)){a.position=b;a.multiShot=false;f()}return a};n=function(){var a,c=d._iO.onposition;if(c)for(a in c)if(c.hasOwnProperty(a))d.onPosition(parseInt(a,10),c[a])};t=function(){var a,c=d._iO.onposition;if(c)for(a in c)c.hasOwnProperty(a)&&d.clearOnPosition(parseInt(a,10))};k=function(){d.isHTML5&&
Pa(d)};e=function(){d.isHTML5&&Qa(d)};g=function(a){if(!a){u=[];s=0}m=false;d._hasTimer=null;d._a=null;d._html5_canplay=false;d.bytesLoaded=null;d.bytesTotal=null;d.duration=d._iO&&d._iO.duration?d._iO.duration:null;d.durationEstimate=null;d.buffered=[];d.eqData=[];d.eqData.left=[];d.eqData.right=[];d.failures=0;d.isBuffering=false;d.instanceOptions={};d.instanceCount=0;d.loaded=false;d.metadata={};d.readyState=0;d.muted=false;d.paused=false;d.peakData={left:0,right:0};d.waveformData={left:[],right:[]};
d.playState=0;d.position=null;d.id3={}};g();this._onTimer=function(a){var c,o=false,g={};if(d._hasTimer||a){if(d._a&&(a||(d.playState>0||d.readyState===1)&&!d.paused)){c=d._get_html5_duration();if(c!==b){b=c;d.duration=c;o=true}d.durationEstimate=d.duration;c=d._a.currentTime*1E3||0;if(c!==f){f=c;o=true}(o||a)&&d._whileplaying(c,g,g,g,g)}return o}};this._get_html5_duration=function(){var a=d._iO,c=d._a?d._a.duration*1E3:a?a.duration:void 0;return c&&!isNaN(c)&&c!==Infinity?c:a?a.duration:null};this._apply_loop=
function(a,d){!a.loop&&d>1&&c._wD("Note: Native HTML5 looping is infinite.");a.loop=d>1?"loop":""};this._setup_html5=function(a){var a=B(d._iO,a),b=decodeURI,o=M?c._global_a:d._a,f=b(a.url),i=o&&o._t?o._t.instanceOptions:null,e;if(o){if(o._t){if(!M&&f===b(p))e=o;else if(M&&i.url===a.url&&(!p||p===i.url))e=o;if(e){d._apply_loop(o,a.loops);return e}}c._wD("setting URL on existing object: "+f+(p?", old URL: "+p:""));M&&(o._t&&o._t.playState&&a.url!==i.url)&&o._t.stop();g(i&&i.url?a.url===i.url:p?p===
a.url:false);o.src=a.url;p=d.url=a.url;o._called_load=false}else{w("h5a");d._a=a.autoLoad||a.autoPlay?new Audio(a.url):Xa?new Audio(null):new Audio;o=d._a;o._called_load=false;if(M)c._global_a=o}d.isHTML5=true;d._a=o;o._t=d;h();d._apply_loop(o,a.loops);if(a.autoLoad||a.autoPlay)d.load();else{o.autobuffer=false;o.preload="auto"}return o};h=function(){if(d._a._added_events)return false;var a;d._a._added_events=true;for(a in H)H.hasOwnProperty(a)&&d._a&&d._a.addEventListener(a,H[a],false);return true};
i=function(){var a;c._wD(q+"removing event listeners: "+d.id);d._a._added_events=false;for(a in H)H.hasOwnProperty(a)&&d._a&&d._a.removeEventListener(a,H[a],false)};this._onload=function(a){a=!!a||!d.isHTML5&&v===8&&d.duration;c._wD('SMSound._onload(): "'+d.id+'"'+(a?" loaded.":" failed to load? - "+d.url),a?1:2);if(!a&&!d.isHTML5){c.sandbox.noRemote===true&&c._wD("SMSound._onload(): "+x("noNet"),1);c.sandbox.noLocal===true&&c._wD("SMSound._onload(): "+x("noLocal"),1)}d.loaded=a;d.readyState=a?3:
2;d._onbufferchange(0);d._iO.onload&&d._iO.onload.apply(d,[a]);return true};this._onbufferchange=function(a){if(d.playState===0||a&&d.isBuffering||!a&&!d.isBuffering)return false;d.isBuffering=a===1;if(d._iO.onbufferchange){c._wD("SMSound._onbufferchange(): "+a);d._iO.onbufferchange.apply(d)}return true};this._onsuspend=function(){if(d._iO.onsuspend){c._wD("SMSound._onsuspend()");d._iO.onsuspend.apply(d)}return true};this._onfailure=function(a,b,o){d.failures++;c._wD('SMSound._onfailure(): "'+d.id+
'" count '+d.failures);if(d._iO.onfailure&&d.failures===1)d._iO.onfailure(d,a,b,o);else c._wD("SMSound._onfailure(): ignoring")};this._onfinish=function(){var a=d._iO.onfinish;d._onbufferchange(0);d._resetOnPosition(0);if(d.instanceCount){d.instanceCount--;if(!d.instanceCount){t();d.playState=0;d.paused=false;d.instanceCount=0;d.instanceOptions={};d._iO={};e();if(d.isHTML5)d.position=0}if((!d.instanceCount||d._iO.multiShotEvents)&&a){c._wD('SMSound._onfinish(): "'+d.id+'"');a.apply(d)}}};this._whileloading=
function(a,c,b,o){var f=d._iO;d.bytesLoaded=a;d.bytesTotal=c;d.duration=Math.floor(b);d.bufferLength=o;if(f.isMovieStar)d.durationEstimate=d.duration;else{d.durationEstimate=f.duration?d.duration>f.duration?d.duration:f.duration:parseInt(d.bytesTotal/d.bytesLoaded*d.duration,10);if(typeof d.durationEstimate==="undefined")d.durationEstimate=d.duration}if(!d.isHTML5)d.buffered=[{start:0,end:d.duration}];(d.readyState!==3||d.isHTML5)&&f.whileloading&&f.whileloading.apply(d)};this._whileplaying=function(a,
c,b,o,f){var g=d._iO;if(isNaN(a)||a===null)return false;d.position=Math.max(0,a);d._processOnPosition();if(!d.isHTML5&&v>8){if(g.usePeakData&&typeof c!=="undefined"&&c)d.peakData={left:c.leftPeak,right:c.rightPeak};if(g.useWaveformData&&typeof b!=="undefined"&&b)d.waveformData={left:b.split(","),right:o.split(",")};if(g.useEQData&&typeof f!=="undefined"&&f&&f.leftEQ){a=f.leftEQ.split(",");d.eqData=a;d.eqData.left=a;if(typeof f.rightEQ!=="undefined"&&f.rightEQ)d.eqData.right=f.rightEQ.split(",")}}if(d.playState===
1){!d.isHTML5&&(v===8&&!d.position&&d.isBuffering)&&d._onbufferchange(0);g.whileplaying&&g.whileplaying.apply(d)}return true};this._oncaptiondata=function(a){c._wD('SMSound._oncaptiondata(): "'+this.id+'" caption data received.');d.captiondata=a;d._iO.oncaptiondata&&d._iO.oncaptiondata.apply(d)};this._onmetadata=function(a,b){c._wD('SMSound._onmetadata(): "'+this.id+'" metadata received.');var o={},f,g;f=0;for(g=a.length;f<g;f++)o[a[f]]=b[f];d.metadata=o;d._iO.onmetadata&&d._iO.onmetadata.apply(d)};
this._onid3=function(a,b){c._wD('SMSound._onid3(): "'+this.id+'" ID3 data received.');var o=[],f,g;f=0;for(g=a.length;f<g;f++)o[a[f]]=b[f];d.id3=B(d.id3,o);d._iO.onid3&&d._iO.onid3.apply(d)};this._onconnect=function(a){a=a===1;c._wD('SMSound._onconnect(): "'+d.id+'"'+(a?" connected.":" failed to connect? - "+d.url),a?1:2);if(d.connected=a){d.failures=0;y(d.id)&&(d.getAutoPlay()?d.play(void 0,d.getAutoPlay()):d._iO.autoLoad&&d.load());d._iO.onconnect&&d._iO.onconnect.apply(d,[a])}};this._ondataerror=
function(a){if(d.playState>0){c._wD("SMSound._ondataerror(): "+a);d._iO.ondataerror&&d._iO.ondataerror.apply(d)}}};ia=function(){return p.body||p._docElement||p.getElementsByTagName("div")[0]};u=function(a){return p.getElementById(a)};B=function(a,b){var f=a||{},d,g;d=typeof b==="undefined"?c.defaultOptions:b;for(g in d)d.hasOwnProperty(g)&&typeof f[g]==="undefined"&&(f[g]=typeof d[g]!=="object"||d[g]===null?d[g]:B(f[g],d[g]));return f};N={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1};
ta=function(a,b){var f,d=true,g=typeof b!=="undefined",h=c.setupOptions;if(typeof a==="undefined"){d=[];for(f in h)h.hasOwnProperty(f)&&d.push(f);for(f in N)N.hasOwnProperty(f)&&(typeof c[f]==="object"?d.push(f+": {...}"):c[f]instanceof Function?d.push(f+": function() {...}"):d.push(f));c._wD(x("setup",d.join(", ")));return false}for(f in a)if(a.hasOwnProperty(f))if(typeof a[f]!=="object"||a[f]===null||a[f]instanceof Array)if(g&&typeof N[b]!=="undefined")c[b][f]=a[f];else if(typeof h[f]!=="undefined"){c.setupOptions[f]=
a[f];c[f]=a[f]}else if(typeof N[f]==="undefined"){U(x(typeof c[f]==="undefined"?"setupUndef":"setupError",f),2);d=false}else c[f]instanceof Function?c[f].apply(c,a[f]instanceof Array?a[f]:[a[f]]):c[f]=a[f];else if(typeof N[f]==="undefined"){U(x(typeof c[f]==="undefined"?"setupUndef":"setupError",f),2);d=false}else return ta(a[f],f);return d};var db=function(a){var a=Ua.call(a),c=a.length;if(ra){a[1]="on"+a[1];c>3&&a.pop()}else c===3&&a.push(false);return a},eb=function(a,c){var b=a.shift(),d=[jb[c]];
if(ra)b[d](a[0],a[1]);else b[d].apply(b,a)},ra=t.attachEvent,jb={add:ra?"attachEvent":"addEventListener",remove:ra?"detachEvent":"removeEventListener"};C={add:function(){eb(db(arguments),"add")},remove:function(){eb(db(arguments),"remove")}};H={abort:f(function(){c._wD(q+"abort: "+this._t.id)}),canplay:f(function(){var a=this._t,b;if(a._html5_canplay)return true;a._html5_canplay=true;c._wD(q+"canplay: "+a.id+", "+a.url);a._onbufferchange(0);b=typeof a._iO.position!=="undefined"&&!isNaN(a._iO.position)?
a._iO.position/1E3:null;if(a.position&&this.currentTime!==b){c._wD(q+"canplay: setting position to "+b);try{this.currentTime=b}catch(f){c._wD(q+"setting position of "+b+" failed: "+f.message,2)}}a._iO._oncanplay&&a._iO._oncanplay()}),canplaythrough:f(function(){var a=this._t;if(!a.loaded){a._onbufferchange(0);a._whileloading(a.bytesLoaded,a.bytesTotal,a._get_html5_duration());a._onload(true)}}),ended:f(function(){var a=this._t;c._wD(q+"ended: "+a.id);a._onfinish()}),error:f(function(){c._wD(q+"error: "+
this.error.code);this._t._onload(false)}),loadeddata:f(function(){var a=this._t;c._wD(q+"loadeddata: "+this._t.id);if(!a._loaded&&!Ga)a.duration=a._get_html5_duration()}),loadedmetadata:f(function(){c._wD(q+"loadedmetadata: "+this._t.id)}),loadstart:f(function(){c._wD(q+"loadstart: "+this._t.id);this._t._onbufferchange(1)}),play:f(function(){c._wD(q+"play: "+this._t.id+", "+this._t.url);this._t._onbufferchange(0)}),playing:f(function(){c._wD(q+"playing: "+this._t.id);this._t._onbufferchange(0)}),
progress:f(function(a){var b=this._t,f,d,g;f=0;var h=a.type==="progress",i=a.target.buffered,e=a.loaded||0,k=a.total||1;b.buffered=[];if(i&&i.length){f=0;for(d=i.length;f<d;f++)b.buffered.push({start:i.start(f),end:i.end(f)});f=i.end(0)-i.start(0);e=f/a.target.duration;if(h&&i.length>1){g=[];d=i.length;for(f=0;f<d;f++)g.push(a.target.buffered.start(f)+"-"+a.target.buffered.end(f));c._wD(q+"progress: timeRanges: "+g.join(", "))}h&&!isNaN(e)&&c._wD(q+"progress: "+b.id+": "+Math.floor(e*100)+"% loaded")}if(!isNaN(e)){b._onbufferchange(0);
b._whileloading(e,k,b._get_html5_duration());e&&(k&&e===k)&&H.canplaythrough.call(this,a)}}),ratechange:f(function(){c._wD(q+"ratechange: "+this._t.id)}),suspend:f(function(a){var b=this._t;c._wD(q+"suspend: "+b.id);H.progress.call(this,a);b._onsuspend()}),stalled:f(function(){c._wD(q+"stalled: "+this._t.id)}),timeupdate:f(function(){this._t._onTimer()}),waiting:f(function(){var a=this._t;c._wD(q+"waiting: "+a.id);a._onbufferchange(1)})};pa=function(a){return a.serverURL||a.type&&g(a.type)?false:
a.type?da({type:a.type}):da({url:a.url})||c.html5Only};Ca=function(a,c){if(a)a.src=c};da=function(a){if(!c.useHTML5Audio||!c.hasHTML5)return false;var b=a.url||null,a=a.type||null,f=c.audioFormats,d;if(a&&typeof c.html5[a]!=="undefined")return c.html5[a]&&!g(a);if(!J){J=[];for(d in f)if(f.hasOwnProperty(d)){J.push(d);f[d].related&&(J=J.concat(f[d].related))}J=RegExp("\\.("+J.join("|")+")(\\?.*)?$","i")}d=b?b.toLowerCase().match(J):null;if(!d||!d.length){if(a){b=a.indexOf(";");d=(b!==-1?a.substr(0,
b):a).substr(6)}}else d=d[1];if(d&&typeof c.html5[d]!=="undefined")b=c.html5[d]&&!g(d);else{a="audio/"+d;b=c.html5.canPlayType({type:a});b=(c.html5[d]=b)&&c.html5[a]&&!g(a)}return b};Ta=function(){function a(d){var f,g,o=f=false;if(!b||typeof b.canPlayType!=="function")return f;if(d instanceof Array){f=0;for(g=d.length;f<g&&!o;f++)if(c.html5[d[f]]||b.canPlayType(d[f]).match(c.html5Test)){o=true;c.html5[d[f]]=true;c.flash[d[f]]=!!d[f].match($a)}f=o}else{d=b&&typeof b.canPlayType==="function"?b.canPlayType(d):
false;f=!(!d||!d.match(c.html5Test))}return f}if(!c.useHTML5Audio||typeof Audio==="undefined")return false;var b=typeof Audio!=="undefined"?Xa?new Audio(null):new Audio:null,f,d,g={},h;h=c.audioFormats;for(f in h)if(h.hasOwnProperty(f)){d="audio/"+f;g[f]=a(h[f].type);g[d]=g[f];if(f.match($a)){c.flash[f]=true;c.flash[d]=true}else{c.flash[f]=false;c.flash[d]=false}if(h[f]&&h[f].related)for(d=h[f].related.length-1;d>=0;d--){g["audio/"+h[f].related[d]]=g[f];c.html5[h[f].related[d]]=g[f];c.flash[h[f].related[d]]=
g[f]}}g.canPlayType=b?a:null;c.html5=B(c.html5,g);return true};ga={notReady:"Not loaded yet - wait for soundManager.onready()",notOK:"Audio support is not available.",domError:"soundManager::createMovie(): appendChild/innerHTML call failed. DOM not ready or other error.",spcWmode:"soundManager::createMovie(): Removing wmode, preventing known SWF loading issue(s)",swf404:"soundManager: Verify that %s is a valid path.",tryDebug:"Try soundManager.debugFlash = true for more security details (output goes to SWF.)",
checkSWF:"See SWF output for more debug info.",localFail:"soundManager: Non-HTTP page ("+p.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:"soundManager: Special case: Waiting for SWF to load with window focus...",waitImpatient:"soundManager: Getting impatient, still waiting for Flash%s...",waitForever:"soundManager: Waiting indefinitely for Flash (will recover if unblocked)...",
waitSWF:"soundManager: Retrying, waiting for 100% SWF load...",needFunction:"soundManager: Function object expected for %s",badID:'Warning: Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:"--- soundManager._debug(): Current sound objects ---",waitEI:"soundManager::initMovie(): Waiting for ExternalInterface call from Flash...",waitOnload:"soundManager: Waiting for window.onload()",docLoaded:"soundManager: Document already loaded",onload:"soundManager::initComplete(): calling soundManager.onload()",
onloadOK:"soundManager.onload() complete",init:"soundManager::init()",didInit:"soundManager::init(): Already called?",flashJS:"soundManager: Attempting JS to Flash call...",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:"Warning: Failed to remove flash movie.",shutdown:"soundManager.disable(): Shutting down",
queue:"soundManager: Queueing %s handler",smFail:"soundManager: Failed to initialise.",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying .swf_timedout CSS...",fbLoaded:"Flash loaded",fbHandler:"soundManager::flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:"soundManager.load(): current URL already assigned.",badFV:'soundManager.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",
noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",mfOn:"mobileFlash::enabling on-screen flash repositioning",policy:"Enabling usePolicyFile for data access",setup:"soundManager.setup(): allowed parameters: %s",setupError:'soundManager.setup(): "%s" cannot be assigned with this method.',setupUndef:'soundManager.setup(): Could not find option "%s"',
setupLate:"soundManager.setup(): url + flashVersion changes will not take effect until reboot().",h5a:"creating HTML5 Audio() object"};x=function(){var a=Ua.call(arguments),c=a.shift(),c=ga&&ga[c]?ga[c]:"",b,d;if(c&&a&&a.length){b=0;for(d=a.length;b<d;b++)c=c.replace("%s",a[b])}return c};la=function(a){if(v===8&&a.loops>1&&a.stream){w("as2loop");a.stream=false}return a};ma=function(a,b){if(a&&!a.usePolicyFile&&(a.onid3||a.usePeakData||a.useWaveformData||a.useEQData)){c._wD((b||"")+x("policy"));a.usePolicyFile=
true}return a};U=function(a){typeof console!=="undefined"&&typeof console.warn!=="undefined"?console.warn(a):c._wD(a)};r=function(){return false};Ma=function(a){for(var c in a)a.hasOwnProperty(c)&&typeof a[c]==="function"&&(a[c]=r)};ka=function(a){typeof a==="undefined"&&(a=false);if(D||a){w("smFail",2);c.disable(a)}};Na=function(a){var b=null;if(a)if(a.match(/\.swf(\?.*)?$/i)){if(b=a.substr(a.toLowerCase().lastIndexOf(".swf?")+4))return a}else a.lastIndexOf("/")!==a.length-1&&(a=a+"/");a=(a&&a.lastIndexOf("/")!==
-1?a.substr(0,a.lastIndexOf("/")+1):"./")+c.movieURL;c.noSWFCache&&(a=a+("?ts="+(new Date).getTime()));return a};va=function(){v=parseInt(c.flashVersion,10);if(v!==8&&v!==9){c._wD(x("badFV",v,8));c.flashVersion=v=8}var a=c.debugMode||c.debugFlash?"_debug.swf":".swf";if(c.useHTML5Audio&&!c.html5Only&&c.audioFormats.mp4.required&&v<9){c._wD(x("needfl9"));c.flashVersion=v=9}c.version=c.versionNumber+(c.html5Only?" (HTML5-only mode)":v===9?" (AS3/Flash 9)":" (AS2/Flash 8)");if(v>8){c.defaultOptions=B(c.defaultOptions,
c.flash9Options);c.features.buffering=true;c.defaultOptions=B(c.defaultOptions,c.movieStarOptions);c.filePatterns.flash9=RegExp("\\.(mp3|"+cb.join("|")+")(\\?.*)?$","i");c.features.movieStar=true}else c.features.movieStar=false;c.filePattern=c.filePatterns[v!==8?"flash9":"flash8"];c.movieURL=(v===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",a);c.features.peakData=c.features.waveformData=c.features.eqData=v>8};La=function(a,c){if(!l)return false;l._setPolling(a,c)};ya=function(){if(c.debugURLParam.test(A))c.debugMode=
true;if(u(c.debugID))return false;var a,b,f,d;if(c.debugMode&&!u(c.debugID)&&(!Ya||!c.useConsole||!c.consoleOnly)){a=p.createElement("div");a.id=c.debugID+"-toggle";b={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001};a.appendChild(p.createTextNode("-"));a.onclick=Oa;a.title="Toggle SM2 debug console";if(s.match(/msie 6/i)){a.style.position=
"absolute";a.style.cursor="hand"}for(d in b)b.hasOwnProperty(d)&&(a.style[d]=b[d]);b=p.createElement("div");b.id=c.debugID;b.style.display=c.debugMode?"block":"none";if(c.debugMode&&!u(a.id)){try{f=ia();f.appendChild(a)}catch(g){throw Error(x("domError")+" \n"+g.toString());}f.appendChild(b)}}};y=this.getSoundById;w=function(a,b){return!a?"":c._wD(x(a),b)};A.indexOf("sm2-debug=alert")+1&&c.debugMode&&(c._wD=function(a){e.alert(a)});Oa=function(){var a=u(c.debugID),b=u(c.debugID+"-toggle");if(!a)return false;
if(sa){b.innerHTML="+";a.style.display="none"}else{b.innerHTML="-";a.style.display="block"}sa=!sa};E=function(a,c,b){if(typeof sm2Debugger!=="undefined")try{sm2Debugger.handleEvent(a,c,b)}catch(d){}return true};T=function(){var a=[];c.debugMode&&a.push("sm2_debug");c.debugFlash&&a.push("flash_debug");c.useHighPerformance&&a.push("high_performance");return a.join(" ")};Aa=function(){var a=x("fbHandler"),b=c.getMoviePercent(),f={type:"FLASHBLOCK"};if(c.html5Only)return false;if(c.ok()){c.didFlashBlock&&
c._wD(a+": Unblocked");if(c.oMC)c.oMC.className=[T(),"movieContainer","swf_loaded"+(c.didFlashBlock?" swf_unblocked":"")].join(" ")}else{if(G){c.oMC.className=T()+" movieContainer "+(b===null?"swf_timedout":"swf_error");c._wD(a+": "+x("fbTimeout")+(b?" ("+x("fbLoaded")+")":""))}c.didFlashBlock=true;O({type:"ontimeout",ignoreInit:true,error:f});S(f)}};ua=function(a,c,b){typeof I[a]==="undefined"&&(I[a]=[]);I[a].push({method:c,scope:b||null,fired:false})};O=function(a){a||(a={type:c.ok()?"onready":
"ontimeout"});if(!z&&a&&!a.ignoreInit||a.type==="ontimeout"&&(c.ok()||D&&!a.ignoreInit))return false;var b={success:a&&a.ignoreInit?c.ok():!D},f=a&&a.type?I[a.type]||[]:[],d=[],g,h=[b],i=G&&c.useFlashBlock&&!c.ok();if(a.error)h[0].error=a.error;b=0;for(g=f.length;b<g;b++)f[b].fired!==true&&d.push(f[b]);if(d.length){c._wD("soundManager: Firing "+d.length+" "+a.type+"() item"+(d.length===1?"":"s"));b=0;for(g=d.length;b<g;b++){d[b].scope?d[b].method.apply(d[b].scope,h):d[b].method.apply(this,h);if(!i)d[b].fired=
true}}return true};P=function(){t.setTimeout(function(){c.useFlashBlock&&Aa();O();if(typeof c.onload==="function"){w("onload",1);c.onload.apply(t);w("onloadOK",1)}c.waitForWindowLoad&&C.add(t,"load",P)},1)};Ea=function(){if(typeof F!=="undefined")return F;var a=false,c=navigator,b=c.plugins,d,f=t.ActiveXObject;if(b&&b.length)(c=c.mimeTypes)&&(c["application/x-shockwave-flash"]&&c["application/x-shockwave-flash"].enabledPlugin&&c["application/x-shockwave-flash"].enabledPlugin.description)&&(a=true);
else if(typeof f!=="undefined"){try{d=new f("ShockwaveFlash.ShockwaveFlash")}catch(g){}a=!!d}return F=a};Sa=function(){var a,b,f=c.audioFormats;if(Fa&&s.match(/os (1|2|3_0|3_1)/i)){c.hasHTML5=false;c.html5Only=true;if(c.oMC)c.oMC.style.display="none"}else if(c.useHTML5Audio){if(!c.html5||!c.html5.canPlayType){c._wD("SoundManager: No HTML5 Audio() support detected.");c.hasHTML5=false}else c.hasHTML5=true;Ia&&c._wD("soundManager::Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+
(!F?" would use flash fallback for MP3/MP4, but none detected.":"will use flash fallback for MP3/MP4, if available"),1)}if(c.useHTML5Audio&&c.hasHTML5)for(b in f)if(f.hasOwnProperty(b)&&(f[b].required&&!c.html5.canPlayType(f[b].type)||c.preferFlash&&(c.flash[b]||c.flash[f[b].type])))a=true;c.ignoreFlash&&(a=false);c.html5Only=c.hasHTML5&&c.useHTML5Audio&&!a;return!c.html5Only};oa=function(a){var b,f,d=0;if(a instanceof Array){b=0;for(f=a.length;b<f;b++)if(a[b]instanceof Object){if(c.canPlayMIME(a[b].type)){d=
b;break}}else if(c.canPlayURL(a[b])){d=b;break}if(a[d].url)a[d]=a[d].url;a=a[d]}return a};Pa=function(a){if(!a._hasTimer){a._hasTimer=true;if(!Ha&&c.html5PollingInterval){ca===null&&na===0&&(ca=t.setInterval(Ra,c.html5PollingInterval));na++}}};Qa=function(a){if(a._hasTimer){a._hasTimer=false;!Ha&&c.html5PollingInterval&&na--}};Ra=function(){var a;if(ca!==null&&!na){t.clearInterval(ca);ca=null;return false}for(a=c.soundIDs.length-1;a>=0;a--)c.sounds[c.soundIDs[a]].isHTML5&&c.sounds[c.soundIDs[a]]._hasTimer&&
c.sounds[c.soundIDs[a]]._onTimer()};S=function(a){a=typeof a!=="undefined"?a:{};typeof c.onerror==="function"&&c.onerror.apply(t,[{type:typeof a.type!=="undefined"?a.type:null}]);typeof a.fatal!=="undefined"&&a.fatal&&c.disable()};Va=function(){if(!Ia||!Ea())return false;var a=c.audioFormats,b,f;for(f in a)if(a.hasOwnProperty(f)&&(f==="mp3"||f==="mp4")){c._wD("soundManager: Using flash fallback for "+f+" format");c.html5[f]=false;if(a[f]&&a[f].related)for(b=a[f].related.length-1;b>=0;b--)c.html5[a[f].related[b]]=
false}};this._setSandboxType=function(a){var b=c.sandbox;b.type=a;b.description=b.types[typeof b.types[a]!=="undefined"?a:"unknown"];c._wD("Flash security sandbox type: "+b.type);if(b.type==="localWithFile"){b.noRemote=true;b.noLocal=false;w("secNote",2)}else if(b.type==="localWithNetwork"){b.noRemote=false;b.noLocal=true}else if(b.type==="localTrusted"){b.noRemote=false;b.noLocal=false}};this._externalInterfaceOK=function(a,b){if(c.swfLoaded)return false;var f,d=(new Date).getTime();c._wD("soundManager::externalInterfaceOK()"+
(a?" (~"+(d-a)+" ms)":""));E("swf",true);E("flashtojs",true);c.swfLoaded=true;qa=false;Ia&&Va();if(!b||b.replace(/\+dev/i,"")!==c.versionNumber.replace(/\+dev/i,"")){f='soundManager: Fatal: JavaScript file build "'+c.versionNumber+'" does not match Flash SWF build "'+b+'" at '+c.url+". Ensure both are up-to-date.";setTimeout(function(){throw Error(f);},0);return false}setTimeout(W,K?100:1)};ja=function(a,b){function f(){c._wD("-- SoundManager 2 "+c.version+(!c.html5Only&&c.useHTML5Audio?c.hasHTML5?
" + HTML5 audio":", no HTML5 audio support":"")+(!c.html5Only?(c.useHighPerformance?", high performance mode, ":", ")+((c.flashPollingInterval?"custom ("+c.flashPollingInterval+"ms)":"normal")+" polling")+(c.wmode?", wmode: "+c.wmode:"")+(c.debugFlash?", flash debug mode":"")+(c.useFlashBlock?", flashBlock mode":""):"")+" --",1)}function d(a,c){return'<param name="'+a+'" value="'+c+'" />'}if(X&&Y)return false;if(c.html5Only){va();f();c.oMC=u(c.movieID);W();Y=X=true;return false}var g=b||c.url,h=c.altURL||
g,i;i=ia();var e,q,k=T(),m,n=null,n=(n=p.getElementsByTagName("html")[0])&&n.dir&&n.dir.match(/rtl/i),a=typeof a==="undefined"?c.id:a;va();c.url=Na(V?g:h);b=c.url;c.wmode=!c.wmode&&c.useHighPerformance?"transparent":c.wmode;if(c.wmode!==null&&(s.match(/msie 8/i)||!K&&!c.useHighPerformance)&&navigator.platform.match(/win32|win64/i)){w("spcWmode");c.wmode=null}i={name:a,id:a,src:b,quality:"high",allowScriptAccess:c.allowScriptAccess,bgcolor:c.bgColor,pluginspage:ab+"www.macromedia.com/go/getflashplayer",
title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:c.wmode,hasPriority:"true"};if(c.debugFlash)i.FlashVars="debug=1";c.wmode||delete i.wmode;if(K){g=p.createElement("div");q=['<object id="'+a+'" data="'+b+'" type="'+i.type+'" title="'+i.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+ab+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',d("movie",b),d("AllowScriptAccess",c.allowScriptAccess),d("quality",
i.quality),c.wmode?d("wmode",c.wmode):"",d("bgcolor",c.bgColor),d("hasPriority","true"),c.debugFlash?d("FlashVars",i.FlashVars):"","</object>"].join("")}else{g=p.createElement("embed");for(e in i)i.hasOwnProperty(e)&&g.setAttribute(e,i[e])}ya();k=T();if(i=ia()){c.oMC=u(c.movieID)||p.createElement("div");if(c.oMC.id){m=c.oMC.className;c.oMC.className=(m?m+" ":"movieContainer")+(k?" "+k:"");c.oMC.appendChild(g);if(K){e=c.oMC.appendChild(p.createElement("div"));e.className="sm2-object-box";e.innerHTML=
q}Y=true}else{c.oMC.id=c.movieID;c.oMC.className="movieContainer "+k;e=k=null;if(!c.useFlashBlock)if(c.useHighPerformance)k={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"};else{k={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"};if(n)k.left=Math.abs(parseInt(k.left,10))+"px"}if(hb)c.oMC.style.zIndex=1E4;if(!c.debugFlash)for(m in k)k.hasOwnProperty(m)&&(c.oMC.style[m]=k[m]);try{K||c.oMC.appendChild(g);i.appendChild(c.oMC);if(K){e=c.oMC.appendChild(p.createElement("div"));
e.className="sm2-object-box";e.innerHTML=q}Y=true}catch(l){throw Error(x("domError")+" \n"+l.toString());}}}X=true;f();c._wD("soundManager::createMovie(): Trying to load "+b+(!V&&c.altURL?" (alternate URL)":""),1);return true};ha=function(){if(c.html5Only){ja();return false}if(l)return false;l=c.getMovie(c.id);if(!l){if(aa){K?c.oMC.innerHTML=za:c.oMC.appendChild(aa);aa=null;X=true}else ja(c.id,c.url);l=c.getMovie(c.id)}l&&w("waitEI");typeof c.oninitmovie==="function"&&setTimeout(c.oninitmovie,1);
return true};Q=function(){setTimeout(Ka,1E3)};Ka=function(){var a,b=false;if(ba)return false;ba=true;C.remove(t,"load",Q);if(qa&&!Ja){w("waitFocus");return false}if(!z){a=c.getMoviePercent();c._wD(x("waitImpatient",a>0?" (SWF "+a+"% loaded)":""));a>0&&a<100&&(b=true)}setTimeout(function(){a=c.getMoviePercent();if(b){ba=false;c._wD(x("waitSWF"));t.setTimeout(Q,1);return false}if(!z){c._wD("soundManager: No Flash response within expected time.\nLikely causes: "+(a===0?"Loading "+c.movieURL+" may have failed (and/or Flash "+
v+"+ not present?), ":"")+"Flash blocked or JS-Flash security error."+(c.debugFlash?" "+x("checkSWF"):""),2);if(!V&&a){w("localFail",2);c.debugFlash||w("tryDebug",2)}a===0&&c._wD(x("swf404",c.url));E("flashtojs",false,": Timed out"+V?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)")}if(!z&&Za)if(a===null)if(c.useFlashBlock||c.flashLoadTimeout===0){c.useFlashBlock&&Aa();w("waitForever")}else ka(true);else c.flashLoadTimeout===0?w("waitForever"):ka(true)},c.flashLoadTimeout)};
fa=function(){if(Ja||!qa){C.remove(t,"focus",fa);return true}Ja=Za=true;c._wD("soundManager: Got window focus.");ba=false;Q();C.remove(t,"focus",fa);return true};Wa=function(){var a,b=[];if(c.useHTML5Audio&&c.hasHTML5){for(a in c.audioFormats)c.audioFormats.hasOwnProperty(a)&&b.push(a+": "+c.html5[a]+(!c.html5[a]&&F&&c.flash[a]?" (using flash)":c.preferFlash&&c.flash[a]&&F?" (preferring flash)":!c.html5[a]?" ("+(c.audioFormats[a].required?"required, ":"")+"and no flash support)":""));c._wD("-- SoundManager 2: HTML5 support tests ("+
c.html5Test+"): "+b.join(", ")+" --",1)}};Z=function(a){if(z)return false;if(c.html5Only){c._wD("-- SoundManager 2: loaded --");z=true;P();E("onload",true);return true}var b=true,f;if(!c.useFlashBlock||!c.flashLoadTimeout||c.getMoviePercent()){z=true;D&&(f={type:!F&&G?"NO_FLASH":"INIT_TIMEOUT"})}c._wD("-- SoundManager 2 "+(D?"failed to load":"loaded")+" ("+(D?"security/load error":"OK")+") --",1);if(D||a){if(c.useFlashBlock&&c.oMC)c.oMC.className=T()+" "+(c.getMoviePercent()===null?"swf_timedout":
"swf_error");O({type:"ontimeout",error:f,ignoreInit:true});E("onload",false);S(f);b=false}else E("onload",true);if(!D)if(c.waitForWindowLoad&&!ea){w("waitOnload");C.add(t,"load",P)}else{c.waitForWindowLoad&&ea&&w("docLoaded");P()}return b};L=function(){var a,b=c.setupOptions;for(a in b)b.hasOwnProperty(a)&&(typeof c[a]==="undefined"?c[a]=b[a]:c[a]!==b[a]&&(c.setupOptions[a]=c[a]))};W=function(){w("init");if(z){w("didInit");return false}if(c.html5Only){if(!z){C.remove(t,"load",c.beginDelayedInit);
c.enabled=true;Z()}return true}ha();try{w("flashJS");l._externalInterfaceTest(false);La(true,c.flashPollingInterval||(c.useHighPerformance?10:50));c.debugMode||l._disableDebug();c.enabled=true;E("jstoflash",true);c.html5Only||C.add(t,"unload",r)}catch(a){c._wD("js/flash exception: "+a.toString());E("jstoflash",false);S({type:"JS_TO_FLASH_EXCEPTION",fatal:true});ka(true);Z();return false}Z();C.remove(t,"load",c.beginDelayedInit);return true};R=function(){if(xa)return false;xa=true;L();ya();var a=null,
a=null,b=typeof console!=="undefined"&&typeof console.log==="function",f=A.toLowerCase();if(f.indexOf("sm2-usehtml5audio=")!==-1){a=f.charAt(f.indexOf("sm2-usehtml5audio=")+18)==="1";b&&console.log((a?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter");c.setup({useHTML5Audio:a})}if(f.indexOf("sm2-preferflash=")!==-1){a=f.charAt(f.indexOf("sm2-preferflash=")+16)==="1";b&&console.log((a?"Enabling ":"Disabling ")+"preferFlash via URL parameter");c.setup({preferFlash:a})}if(!F&&c.hasHTML5){c._wD("SoundManager: No Flash detected"+
(!c.useHTML5Audio?", enabling HTML5.":". Trying HTML5-only mode."));c.setup({useHTML5Audio:true,preferFlash:false})}Ta();c.html5.usingFlash=Sa();G=c.html5.usingFlash;Wa();if(!F&&G){c._wD("SoundManager: Fatal error: Flash is needed to play some required formats, but is not available.");c.setup({flashLoadTimeout:1})}p.removeEventListener&&p.removeEventListener("DOMContentLoaded",R,false);ha();return true};Da=function(){if(p.readyState==="complete"){R();p.detachEvent("onreadystatechange",Da)}return true};
wa=function(){ea=true;C.remove(t,"load",wa)};Ea();C.add(t,"focus",fa);C.add(t,"load",Q);C.add(t,"load",wa);p.addEventListener?p.addEventListener("DOMContentLoaded",R,!1):p.attachEvent?p.attachEvent("onreadystatechange",Da):(E("onload",!1),S({type:"NO_DOM2_EVENTS",fatal:!0}));"complete"===p.readyState&&setTimeout(R,100)}var b=null;if("undefined"===typeof SM2_DEFER||!SM2_DEFER)b=new a;e.SoundManager=a;e.soundManager=b})(window);(function(e){NumberMaze=function(){var a=this,b=0,h=NumberMaze.State,k,g=!0;this.gameArea=document.getElementById("gameArea");this.gameCanvas=document.getElementById("gameCanvas");this.menuCanvas=document.getElementById("menuCanvas");this.context=this.gameCanvas.getContext("2d");this.screenCtx=this.menuCanvas.getContext("2d");soundManager.setup({url:"audio/soundmanager2.swf",onready:function(){console.log("sm2 ready");a.assetManager.Add("tooltip",a.loader.addImage("images/toolTip.png"));a.assetManager.Add("asteroidSprite",
a.loader.addImage("images/asteroidSprite.png"));a.assetManager.Add("craft",a.loader.addImage("images/craft.png"));h.isMobile||(a.assetManager.Add("explosionA",a.loader.addSound("explosion","audio/explosion.wav")),a.assetManager.Add("levelWinA",a.loader.addSound("levelWin","audio/levelWin.wav")),a.assetManager.Add("targetTouchA",a.loader.addSound("targetTouchA","audio/targetTouch.wav")),a.assetManager.Add("touchLineA",a.loader.addSound("touchLineA","audio/lineTouch.wav")),a.assetManager.Add("clickA",
a.loader.addSound("clickA","audio/click.wav")));a.assetManager.Add("spriteData",a.loader.addJson("images/asteroidSprite.json"));a.loader.start()},ontimeout:function(b){console.log("timed out");console.log(b);a.assetManager.Add("tooltip",a.loader.addImage("images/toolTip.png"));a.assetManager.Add("asteroidSprite",a.loader.addImage("images/asteroidSprite.png"));a.assetManager.Add("craft",a.loader.addImage("images/craft.png"));a.assetManager.Add("spriteData",a.loader.addJson("images/asteroidSprite.json"));
a.loader.start()},useHTML5Audio:!0,preferFlash:!1,debugMode:!1});console.log("sm2 setup");a.loader=new PxLoader;a.assetManager=new NumberMaze.AssetManager(this);a.loader.addCompletionListener(function(){console.log("all sprites loaded");h.isMobile||(a.assetManager.Get("touchLineA").setVolume(20),a.assetManager.Get("levelWinA").setVolume(10));new PxLoader;g=!1;e("#preLoader").hide();k()});var f,m;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/30)};k=function(){console.log("NumberMaze : loadComponents");window.setTimeout(function(){window.scrollTo(0,1)},5E3);h.gridStatus=[];for(var i=0;i<NumberMaze.State.rowCount;i++){h.gridStatus[i]=[];for(var e=0;e<NumberMaze.State.colCount;e++)h.gridStatus[i][e]=0}a.uiManager=new NumberMaze.UIManager(a);a.uiManager.delegate=a;a.engine=new NumberMaze.CoreEngine(a);a.engine.delegate=a.uiManager;a.mainMenu=
new NumberMaze.MainMenu(a);a.mainMenu.delegate=a.uiManager;a.creditsScreen=new NumberMaze.Credits(a);a.creditsScreen.delegate=a.uiManager;a.LBoard=new NumberMaze.LBoard(a);a.LBoard.delegate=a.uiManager;a.pauseScreen=new NumberMaze.PauseScreen(a);a.pauseScreen.delegate=a.uiManager;a.gameOver=new NumberMaze.GameOver(a);a.gameOver.delegate=a.uiManager;a.gameWin=new NumberMaze.WonScreen(a);a.gameWin.delegate=a.uiManager;f=new NumberMaze.GameOver(a);f.delegate=a.uiManager;a.practiseFail=new NumberMaze.PractiseFail(a);
a.practiseFail.delegate=a.uiManager;m=new NumberMaze.StarField(a);window.addEventListener("resize",a.uiManager.resize,!1);window.addEventListener("orientationchange",a.uiManager.resize,!1);a.mousedown=function(c,b){"game"==h.currentScreen&&("waiting"==h.inGameState&&Math.dist(a.engine.getStartLocation(),{x:c,y:b})<20*h.gameWidth/h.maxCanvasWidth&&(h.inGameState="playing"),a.engine.hud.mousedown(c,b))};a.mousemove=function(c,b){m.mousemove(c,b);"game"==h.currentScreen?"playing"==h.inGameState||"ending"==
h.inGameState?a.engine.addPoint(c,b):"waiting"==h.inGameState&&a.engine.mousemove(c,b):"menu"==h.currentScreen?a.mainMenu.mousemove(c,b):"credits"==h.currentScreen?a.creditsScreen.mousemove(c,b):"lboard"==h.currentScreen?a.LBoard.mousemove(c,b):"paused"==h.currentScreen?a.pauseScreen.mousemove(c,b):"gameover"==h.currentScreen?a.gameOver.mousemove(c,b):"gamewon"==h.currentScreen?a.gameWin.mousemove(c,b):"practisefail"==h.currentScreen&&a.practiseFail.mousemove(c,b)};a.mouseup=function(c,b){"paused"==
h.currentScreen?a.pauseScreen.mouseup(c,b):"menu"==h.currentScreen?a.mainMenu.mouseup(c,b):"gameover"==h.currentScreen?a.gameOver.mouseup(c,b):"gamewon"==h.currentScreen?a.gameWin.mouseup(c,b):"lboard"==h.currentScreen?a.LBoard.mouseup(c,b):"credits"==h.currentScreen?a.creditsScreen.mouseup(c,b):"practisefail"==h.currentScreen&&a.practiseFail.mouseup(c,b)};a.resizeLayout=function(c,b){a.engine.resizeLayout(c,b);a.mainMenu.resizeLayout(c,b);a.pauseScreen.resizeLayout(c,b);a.gameOver.resizeLayout(c,
b);a.gameWin.resizeLayout(c,b);a.creditsScreen.resizeLayout(c,b);a.LBoard.resizeLayout(c,b);a.practiseFail.resizeLayout(c,b);m.resizeLayout(c,b)};b=(new Date).getTime();(function l(){var f=(new Date).getTime(),i=(f-b)/1E3;b=f;h.effectsOn=i>1/60?!0:!1;h.effectsOn=!1;m.draw(a.context);!0!=g&&("game"==h.currentScreen?(a.engine.update(i),a.engine.draw(a.context)):"paused"==h.currentScreen?(a.engine.draw(a.context),a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),a.pauseScreen.update(i),
a.pauseScreen.draw(a.screenCtx)):"gameover"==h.currentScreen?(a.engine.update(i),a.engine.draw(a.context),a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),a.gameOver.update(i),a.gameOver.draw(a.screenCtx)):"gamewon"==h.currentScreen?(a.engine.update(i),a.engine.draw(a.context),a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),a.gameWin.update(i),a.gameWin.draw(a.screenCtx)):"menu"==h.currentScreen?(a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),
a.mainMenu.update(i),a.mainMenu.draw(a.screenCtx)):"lboard"==h.currentScreen?(console.log("sdfsd"),a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),a.LBoard.update(i),a.LBoard.draw(a.screenCtx)):"credits"==h.currentScreen?(a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),a.creditsScreen.update(i),a.creditsScreen.draw(a.screenCtx)):"practisefail"==h.currentScreen&&(a.screenCtx.clearRect(0,0,a.menuCanvas.width,a.menuCanvas.height),a.practiseFail.update(i),a.practiseFail.draw(a.screenCtx)));
window.requestAnimFrame(l)})()};e("#profileDiv").hide()}})(jQuery);(function(){NumberMaze.AssetManager=function(){var e={},a={play:function(){}};return{Add:function(a,h){e[a]=h},Get:function(b){return"undefined"==typeof e[b]?a:e[b]}}}})();function PxLoader(e){e=e||{};null==e.statusInterval&&(e.statusInterval=5E3);null==e.loggingDelay&&(e.loggingDelay=2E4);null==e.noProgressTimeout&&(e.noProgressTimeout=Infinity);var a=[],b=[],h,k=+new Date;this.add=function(b){b.tags=new PxLoaderTags(b.tags);if(b.priority==null)b.priority=Infinity;a.push({resource:b,state:0})};this.addProgressListener=function(a,f){b.push({callback:a,tags:new PxLoaderTags(f)})};this.addCompletionListener=function(a,f){b.push({tags:new PxLoaderTags(f),callback:function(c){c.completedCount===
c.totalCount&&a()}})};this.start=function(b){h=+new Date;var f=b,f=f==null?[]:Array.isArray(f)?f:[f],c=function(a){for(var a=a.resource,c=Infinity,b=0;b<a.tags.length;b++)for(var g=0;g<Math.min(f.length,c);g++){if(a.tags[b]==f[g]&&g<c){c=g;if(c===0)break}if(c===0)break}return c};a.sort(function(a,b){var f=c(a),g=c(b);return f<g?-1:f>g?1:a.priority<b.priority?-1:a.priority>b.priority?1:0});for(var b=0,e=a.length;b<e;b++){var k=a[b];k.status=1;k.resource.start(this)}setTimeout(g,100)};var g=function(){for(var b=
false,f=+new Date-k,c=f>=e.noProgressTimeout,f=f>=e.loggingDelay,h=0,q=a.length;h<q;h++){var u=a[h];if(u.status===1){u.resource.checkStatus();if(u.status===1)if(c)u.resource.onTimeout();else b=true}}f&&b&&m();b&&setTimeout(g,e.statusInterval)};this.isBusy=function(){for(var b=0,f=a.length;b<f;b++)if(a[b].status===0||a[b].status===1)return true;return false};var f=function(f,g){for(var c=null,h=0,e=a.length;h<e;h++)if(a[h].resource===f){c=a[h];break}if(!(c==null||c.status!==1)){c.status=g;k=+new Date;
h=0;for(e=b.length;h<e;h++){var m=b[h];if(m.tags.length===0||f.tags.contains(m.tags)){for(var s=c,t=0,A=0,p=0,r=a.length;p<r;p++){var L=a[p],W=false;if(W=m.tags.length===0?true:L.resource.tags.contains(m.tags)){A++;(L.status===2||L.status===3||L.status===4)&&t++}}m.callback({resource:s.resource,loaded:s.status===2,error:s.status===3,timeout:s.status===4,completedCount:t,totalCount:A})}}}};this.onLoad=function(a){f(a,2)};this.onError=function(a){f(a,3)};this.onTimeout=function(a){f(a,4)};var m=this.log=
function(b){if(window.console){var f=Math.round((+new Date-h)/1E3);window.console.log("PxLoader elapsed: "+f+" sec");for(var f=0,c=a.length;f<c;f++){var g=a[f];if(b||g.status===1){var e="PxLoader: #"+f+" "+g.resource.getName();switch(g.status){case 0:e=e+" (Not Started)";break;case 1:e=e+" (Waiting)";break;case 2:e=e+" (Loaded)";break;case 3:e=e+" (Error)";break;case 4:e=e+" (Timeout)"}g.resource.tags.length>0&&(e=e+(" Tags: ["+g.resource.tags.join(",")+"]"));window.console.log(e)}}}}}
function PxLoaderTags(e){this.array=[];this.object={};this.value=null;this.length=0;if(null!==e&&void 0!==e){if(Array.isArray(e))this.array=e;else if("object"===typeof e)for(var a in e)this.array.push(a);else this.array.push(e),this.value=e;this.length=this.array.length;for(e=0;e<this.length;e++)this.object[this.array[e]]=!0}this.contains=function(a){if(0===this.length||0===a.length)return!1;if(1===this.length)return 1===a.length?this.value===a.value:a.object.hasOwnProperty(this.value);if(a.length<
this.length)return a.contains(this);for(var h in this.object)if(a.object[h])return!0;return!1}}Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)});function PxLoaderImage(e,a,b){var h=this,k=null;this.img=new Image;this.tags=a;this.priority=b;var g=function(){"complete"==h.img.readyState&&(i(),k.onLoad(h))},f=function(){i();k.onLoad(h)},m=function(){i();k.onError(h)},i=function(){h.unbind("load",f);h.unbind("readystatechange",g);h.unbind("error",m)};this.start=function(a){k=a;h.bind("load",f);h.bind("readystatechange",g);h.bind("error",m);h.img.src=e};this.checkStatus=function(){h.img.complete&&(i(),k.onLoad(h))};this.onTimeout=function(){i();
if(h.img.complete)k.onLoad(h);else k.onTimeout(h)};this.getName=function(){return e};this.bind=function(a,c){h.img.addEventListener?h.img.addEventListener(a,c,!1):h.img.attachEvent&&h.img.attachEvent("on"+a,c)};this.unbind=function(a,c){h.img.removeEventListener?h.img.removeEventListener(a,c,!1):h.img.detachEvent&&h.img.detachEvent("on"+a,c)}}PxLoader.prototype.addImage=function(e,a,b){e=new PxLoaderImage(e,a,b);this.add(e);return e.img};function PxLoaderSound(e,a,b,h){var k=this,g=null;this.tags=b;this.priority=h;this.sound=soundManager.createSound({id:e,url:a,autoLoad:!1,onload:function(){g.onLoad(k)},onsuspend:function(){g.onTimeout(k)},whileloading:function(){var a=this.bytesLoaded,b=this.bytesTotal;if(0<a&&a===b)g.onLoad(k)}});this.start=function(a){g=a;if(navigator.userAgent.match(/(ipad|iphone|ipod)/i))g.onTimeout(k);else this.sound.load()};this.checkStatus=function(){switch(k.sound.readyState){case 2:g.onError(k);break;case 3:g.onLoad(k)}};
this.onTimeout=function(){g.onTimeout(k)};this.getName=function(){return a}}PxLoader.prototype.addSound=function(e,a,b,h){e=new PxLoaderSound(e,a,b,h);this.add(e);return e.sound};function PxLoaderJson(e,a,b){var h=this,k=null;this.json={};this.tags=a;this.priority=b;this.start=function(a){k=a;console.log("loading json");$.getJSON(e,function(a){h.json.frames=a.frames;h.json.meta=a.meta;h.json.readyState="complete";h.json.complete=!0;k.onLoad(h)})};this.checkStatus=function(){if(h.json.complete)k.onLoad(h)};this.onTimeout=function(){if(h.json.complete)k.onLoad(h);else k.onTimeout(h)};this.getName=function(){return e}}
PxLoader.prototype.addJson=function(e,a,b){e=new PxLoaderJson(e,a,b);this.add(e);return e.json};NumberMaze.AudioManager=function(){var e,a;return{init:function(){e=new Audio("audio/bgm.ogg");e.volume=0.3;e.loop=!0;e.play()},explostion:function(){var a;a=new Audio("audio/clickEffect.ogg");a.volume=0.3;a.play()},click:function(){var a;a=new Audio("audio/clickEffect.ogg");a.volume=0.3;a.play()},chime:function(){(new Audio("audio/chimeEffect.ogg")).play()},mute:function(){a=!0;e.pause()},unMute:function(){a=!1;e.play()},toggleMute:function(){(a=!a)?e.pause():e.play()}}};(function(){NumberMaze.GPlusWrapper=function(){function e(a,b){var b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),h=RegExp("[\\#&]"+b+"=([^&#]*)").exec(a);return null==h?"":h[1]}return{acToken:"",expiresIn:0,login:function(){var a=window.open("https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/userinfo.profile&client_id=716569014051-p55dlk3d7em6249gpmgmdi0rlb0j9asj.apps.googleusercontent.com&redirect_uri=http://www.gethugames.in/numbermaze/oauth.html&response_type=token",
"windowname1","width=640, height=480"),b=window.setInterval(function(){if(-1!=a.document.URL.indexOf("http://www.gethugames.in/numbermaze/oauth.html")){window.clearInterval(b);var h=a.document.URL;acToken=e(h,"access_token");tokenType=e(h,"token_type");expiresIn=e(h,"expires_in");a.close();$.ajax({url:"https://www.googleapis.com/oauth2/v1/tokeninfo?access_token="+acToken,data:null,success:function(){$.ajax({url:"https://www.googleapis.com/oauth2/v1/userinfo?access_token="+acToken,data:null,success:function(a){NumberMaze.State.authProvider=
"google";NumberMaze.State.userInfo=a;$("#notloggedin").hide();$("#loggedin").show();$("#loggedin").html("Welcome, <br/>"+a.name);NumberMaze.State.playerName=a.name;Numbermaze.uiManager.submitScore();console.log(a)},dataType:"jsonp"})},dataType:"jsonp"})}},100)}}}})();(function(){NumberMaze.FBWrapper={share:function(){var e=NumberMaze.State;console.log("FBWraper : share");console.log(NumberMaze.State.fbLoggedin);if(!0==NumberMaze.State.fbLoggedin){console.log("logged in");NumberMaze.State.fbSetForShare=!1;e.fbShareStatus="posting action...";var a="/me/spacemaze:fly_through?maze=http://www.gethugames.in/html5spacemaze&lid="+e.currentLevel+"&score="+game.engine.getScore()+"&access_token="+NumberMaze.State.fbAccessToken;console.log(a);console.log("aa");console.log(a);
FB.ui({method:"feed",name:"HTML5 Space Maze",link:"http://www.gethugames.in/html5spazemaze/",picture:"http://www.gethugames.in/html5spacemaze/images/icon256.png",caption:"Cleared "+(e.currentLevel-1)+" mazes",description:"successfully cleared "+(e.currentLevel-1)+" mazes and won the game, scoring "+Math.round(game.engine.getScore())+" points"},function(){})}else console.log("yet to log in"),NumberMaze.State.fbSetForShare=!0,e.fbShareStatus="logging in...",FB.login(function(a){a.authResponse?NumberMaze.FBWrapper.getUserData():
(console.log("User cancelled login or did not fully authorize."),console.log(a))},{scope:"publish_actions,publish_stream,read_stream"})},getStatus:function(){var e=NumberMaze.State;console.log("FBWrapper : getStatus");e.fbShareStatus="getting user data...";FB.getLoginStatus(function(a){"connected"==a.status?(console.log("fb connected"),NumberMaze.State.fbAccessToken=a.authResponse.accessToken,NumberMaze.FBWrapper.getUserData()):(console.log("fb not connected"),console.log(a))})},getUserData:function(){console.log("FBWraper : get user data");
FB.api("/me",function(e){NumberMaze.State.fbLoggedin=!0;console.log(NumberMaze.State.fbLoggedin);NumberMaze.State.authProvider="facebook";NumberMaze.State.userInfo=e;$("#fbLoginButton").attr("src","images/fbIcon.png");console.log("Good to see you, "+e.name+".");NumberMaze.State.playerName=e.name;NumberMaze.State.fbSetForShare&&NumberMaze.FBWrapper.share()})}}})();(function(){NumberMaze.StarField=function(e){var a=!0,b=0,h=0,k=0,g=0,f=0,m=0,i,n,c=Array(100),l=0,q=0,u=0,s=0,t=e.assetManager.Get("asteroidSprite"),A=e.engine.getGrid().spriteData.frames[52].frame;this.mouseup=function(){};this.mousemove=function(a,c){l=a;q=c};this.reset=function(){};this.resizeLayout=function(a,e){b=a;h=e;k=Math.round(b/2);g=Math.round(h/2);f=(b+h)/2;m=1/f;l=k;q=g;for(var i=0;100>i;i++)c[i]=Array(5),c[i][0]=2*Math.random()*b-2*k,c[i][1]=2*Math.random()*h-2*g,c[i][2]=Math.round(Math.random()*
f),c[i][3]=0,c[i][4]=0};this.update=function(){};this.draw=function(e){e.lineCap="round";e.fillStyle="rgb(0,0,0)";e.strokeStyle="rgb(100, 100, 100)";u=(l-k)/8;s=(q-g)/8;e.drawImage(t,A.x,A.y,A.w,A.h,0,0,b,h);for(var r=0;100>r;r++)if(a=!0,i=c[r][3],n=c[r][4],c[r][0]+=u>>4,c[r][0]>k<<1&&(c[r][0]-=b<<1,a=!1),c[r][0]<-k<<1&&(c[r][0]+=b<<1,a=!1),c[r][1]+=s>>4,c[r][1]>g<<1&&(c[r][1]-=h<<1,a=!1),c[r][1]<-g<<1&&(c[r][1]+=h<<1,a=!1),c[r][2]-=1,c[r][2]>f&&(c[r][2]-=f,a=!1),0>c[r][2]&&(c[r][2]+=f,a=!1),c[r][3]=
k+256*(c[r][0]/c[r][2]),c[r][4]=g+256*(c[r][1]/c[r][2]),0<i&&i<b&&0<n&&n<h&&a)e.lineWidth=2*(2-m*c[r][2]),e.beginPath(),e.moveTo(i,n),e.lineTo(c[r][3],c[r][4]),e.stroke(),e.closePath()};this.reset();this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.State={minCanvasWidth:320,minCanvasHeight:240,maxCanvasWidth:960,maxCanvasHeight:720,lineDelta:3,rowCount:3,colCount:4,gameWidth:960,gameHeight:720,online:!0,isMobile:navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),effectsOn:!0,currentScreen:"menu",inGameState:"waiting",
gameMode:"practise",currentLevel:1,active:!0,gridStatus:[],elapsedtime:0,fbLoggedin:!1,fbSetForShare:!1,fbAccessToken:"",fbShareStatus:"",authProvider:"",playerName:"",soundOn:!0,checkLine:!0}})();(function(){NumberMaze.UIManager=function(e){var a=this;this.delegate=null;var b=NumberMaze.State;this.left=this.top=0;$(e.gameArea).mousedown(function(b){var e=b.pageX-a.left,b=b.pageY-a.top;a.delegate&&a.delegate.mousedown(e,b)});$(e.gameArea).mousemove(function(b){var e=b.pageX-a.left,b=b.pageY-a.top;a.delegate&&a.delegate.mousemove(e,b)});$(e.gameArea).mouseup(function(b){var e=b.pageX-a.left,b=b.pageY-a.top;a.delegate&&a.delegate.mouseup(e,b)});document.addEventListener("touchstart",function(b){b.preventDefault();
var e=b.touches[0],b=e.pageX-a.left,e=e.pageY-a.top;a.delegate&&a.delegate.mousedown(b,e)},!1);document.addEventListener("touchmove",function(b){b.preventDefault();var e=b.touches[0],b=e.pageX-a.left,e=e.pageY-a.top;a.delegate&&a.delegate.mousemove(b,e)},!1);document.addEventListener("touchend",function(b){b.preventDefault();var e=b.changedTouches[0],b=e.pageX-a.left,e=e.pageY-a.top;a.delegate&&a.delegate.mouseup(b,e)},!1);$("#gPlusLoginButton").click(function(){NumberMaze.GPlusWrapper().login()});
$("#fbLoginButton").click(function(){NumberMaze.FBWrapper.share()});$("#muteButton").click(function(){b.soundOn=!b.soundOn;b.soundOn?(e.assetManager.Get("bgm").resume(),$("#muteButton").attr("src","images/musicButtonOn.png")):(e.assetManager.Get("bgm").pause(),$("#muteButton").attr("src","images/musicButtonOff.png"))});this.resize=function(){console.log("UIManager : resize");var h=4/3,k=window.innerWidth,g=window.innerHeight;k/g>h?(g=g<b.minCanvasHeight?b.minCanvasHeight:g,g=g>b.maxCanvasHeight?b.maxCanvasHeight:
g,k=g*h):(k=k<b.minCanvasWidth?b.minCanvasWidth:k,k=k>b.maxCanvasWidth?b.maxCanvasWidth:k,g=k/h);e.gameArea.style.width=k+"px";e.gameArea.style.height=g+"px";e.gameArea.style.marginTop=-g/2+"px";e.gameArea.style.marginLeft=-k/2+"px";e.gameArea.style.fontSize=k/400+"em";e.gameCanvas.width=k;e.gameCanvas.height=g;e.menuCanvas.width=k;e.menuCanvas.height=g;b.gameWidth=k;b.gameHeight=g;a.left=$(e.gameArea).offset().left;a.top=$(e.gameArea).offset().top;NumberMaze.MenuButton.prototype.screenWidth=k;NumberMaze.MenuButton.prototype.screenHeight=
g;console.log(k);a.delegate&&a.delegate.resizeLayout(k,g)};this.gameOver=function(){console.log("gameover");_gaq.push(["_setCustomVar",2,"level",""+b.currentLevel]);"practise"==b.gameMode?(b.currentScreen="practisefail",$(e.menuCanvas).show()):(b.currentScreen="gameover",e.gameOver.score=e.engine.getScore(),e.gameOver.lvlScore=e.engine.getLevelScore(),$("#profileDiv").show(),$(e.menuCanvas).show(),a.submitScore())};this.gameWon=function(){console.log("game won");"practise"==b.gameMode?a.gWonScreenQuit():
(b.currentScreen="gamewon",e.gameWin.score=e.engine.getScore(),e.gameWin.lvlScore=e.engine.getLevelScore(),e.gameWin.bonus=e.engine.getBonusScore(),$("#profileDiv").show(),$(e.menuCanvas).show())};this.pauseButtonPressed=function(){b.currentScreen="paused";$(e.menuCanvas).show()};this.gWonScreenNext=function(){b.currentScreen="game";e.engine.nextLevel();a.resize();$(e.menuCanvas).hide();$("#profileDiv").hide()};this.gWonScreenQuit=function(){b.currentScreen="menu";e.mainMenu.reset();$(e.menuCanvas).show();
$("#profileDiv").hide()};this.pauseScreenResume=function(){b.currentScreen="game";$(e.menuCanvas).hide()};this.pauseScreenRestart=function(){console.log("uimanager : restart");b.currentScreen="game";e.engine.reset();$(e.menuCanvas).hide();$("#profileDiv").hide()};this.pauseScreenQuit=function(){b.currentScreen="menu";e.mainMenu.reset();$(e.menuCanvas).show();$("#socialDiv").show();$("#profileDiv").hide()};this.pauseScreenHelp=function(){};this.mainMenuNewGameEasy=function(){_gaq.push(["_setCustomVar",
1,"difficulty","easy"]);b.currentScreen="game";b.gameMode="easy";e.engine.reset();$(e.menuCanvas).hide();$("#socialDiv").hide()};this.mainMenuNewGameHard=function(){_gaq.push(["_setCustomVar",1,"difficulty","hard"]);b.currentScreen="game";b.gameMode="hard";e.engine.reset();$(e.menuCanvas).hide();$("#socialDiv").hide()};this.mainMenuNewGamePractice=function(){console.log("New Game : Practise");_gaq.push(["_setCustomVar",1,"difficulty","practice"]);b.currentScreen="game";b.gameMode="practise";e.engine.reset();
$(e.menuCanvas).hide();$("#socialDiv").hide()};this.mainMenuLeaderboard=function(){a.delegate.LBoard.reset();b.currentScreen="lboard"};this.mainMenuCredits=function(){b.currentScreen="credits";$("#socialDiv").hide();$("#creditsBox").show()};this.LBoardBack=function(){b.currentScreen="menu"};this.creditsBack=function(){b.currentScreen="menu";$("#creditsBox").hide();$("#socialDiv").show()};this.submitScore=function(){};a.resize()}})();(function(){NumberMaze.LetterSprite=function(e,a,b,h,k){var g=this;this.character=e;this.x=a;this.y=b;this.gridX=h;this.gridY=k;this.radius=30;this.dRadius=5;var f=0,m=Math.PI;this.arcLength=Math.PI/4;var i=0,n=0,c=NumberMaze.State;this.frame=Math.round(29*Math.random());var l=0;this.resizeLayout=function(a){g.radius=a/32};this.jingle=function(){c.gridStatus[g.gridX][g.gridY]=2};this.explode=function(){c.gridStatus[g.gridX][g.gridY]=4;g.frame=33};this.open=function(){g.reset();c.gridStatus[g.gridX][g.gridY]=
1};this.close=function(){c.gridStatus[g.gridX][g.gridY]=3};this.reset=function(){n=i=0;g.frame=Math.round(29*Math.random());c.gridStatus[g.gridX][g.gridY]=0;g.arcLength=Math.PI/4;m=Math.PI;g.radius=c.gameWidth/32};this.update=function(a){var b=c.gridStatus[g.gridX][g.gridY];if(0==b)l++,2<l&&(g.frame=(g.frame+1)%29,l=0);else if(1==b){f+=-2*m*a;g.radius+=g.dRadius/5;if(g.radius>c.gameWidth/32||g.radius<c.gameWidth/64)g.dRadius*=-1;l++;4<l&&(g.frame--,0>g.frame&&(g.frame+=29),l=0)}else 2==b?3.14>g.arcLength?
(g.arcLength*=1.02,m*=1.005,i=6*Math.random()-3,n=6*Math.random()-3,f+=m*a):(g.radius=c.gameWidth/64,c.gridStatus[g.gridX][g.gridY]=3,n=i=0):4==b&&(l++,2<l&&(l=0,g.frame++,49==g.frame&&(c.gridStatus[g.gridX][g.gridY]=3)))};this.draw=function(a){a.moveTo(g.x+i+g.radius*Math.cos(f),g.y+n+g.radius*Math.sin(f));a.arc(g.x+i,g.y+n,g.radius,f,f-g.arcLength,!0);a.moveTo(g.x+i+g.radius*Math.cos(f+3.14),g.y+n+g.radius*Math.sin(f+3.14));a.arc(g.x+i,g.y+n,g.radius,f+3.14,f-g.arcLength+3.14,!0)}}})();(function(){NumberMaze.GameLine=function(e){var a=this,b={x:0,y:0},h=!1,k=0;this.pointArray;this.pointArray2;this.pointArray3;this.pointArray4;this.pointArray5;var g=NumberMaze.State;this.resizeLayout=function(){};this.reset=function(){h=!1;k=10;a.pointArray=[];a.pointArray2=[];a.pointArray3=[];a.pointArray4=[];a.pointArray5=[];var b={x:0.07*NumberMaze.State.gameWidth,y:0.2*NumberMaze.State.gameHeight};a.pointArray.push(b);a.pointArray2.push({x:b.x+5*Math.random(),y:b.y+5*Math.random()});a.pointArray3.push({x:b.x+
5*Math.random(),y:b.y+5*Math.random()});a.pointArray4.push({x:b.x+5*Math.random(),y:b.y+5*Math.random()});a.pointArray5.push({x:b.x+5*Math.random(),y:b.y+5*Math.random()})};this.addPoint=function(f,k){if(!h)if(f<=e.gameCanvas.width/100||k<=e.gameCanvas.height/100||f>=99*e.gameCanvas.width/100||k>=99*e.gameCanvas.height/100)h=!0,a.delegate.lineTouched();else{var i={x:f,y:k};if(Math.sqrt((b.x-f)*(b.x-f)+(b.y-k)*(b.y-k))>g.lineDelta){if(3<a.pointArray.length)for(var n=a.pointArray[a.pointArray.length-
1].x,c=a.pointArray[a.pointArray.length-1].y,l=0;l<a.pointArray.length-10&&!0==g.checkLine;l++)if(Math.twoLineIntersects(f,k,n,c,a.pointArray[l].x,a.pointArray[l].y,a.pointArray[l+1].x,a.pointArray[l+1].y))return h=!0,a.delegate.lineTouched(),!1;a.pointArray.push(i);a.pointArray2.push({x:i.x+5*Math.random(),y:i.y+5*Math.random()});a.pointArray3.push({x:i.x+5*Math.random(),y:i.y+5*Math.random()});a.pointArray4.push({x:i.x+5*Math.random(),y:i.y+5*Math.random()});a.pointArray5.push({x:i.x+5*Math.random(),
y:i.y+5*Math.random()});b=i;return!0}return!1}};this.update=function(){if(h){for(var b=0;b<a.pointArray.length;b++)a.pointArray[b].x-=(320-a.pointArray[b].x)/(100-k),a.pointArray[b].y-=(240-a.pointArray[b].y)/(100-k);k*=1.05;100<k&&(a.delegate.lineExploded(),a.reset())}};this.draw=function(b){var e=a.pointArray.length-1;b.globalCompositeOperation="lighter";b.lineWidth=6;b.lineCap="round";if(h){b.beginPath();b.strokeStyle="rgba(100, 100, 140, "+(0.8-k/100)+")";for(var i=0;i<a.pointArray.length;i++)b.lineTo(a.pointArray[i].x+
Math.random()*k/4,a.pointArray[i].y+Math.random()*k/4)}else{b.beginPath();b.strokeStyle="rgba(200, 200, 100, 0.1)";for(i=0;i<a.pointArray.length;i++)b.lineTo(a.pointArray[i].x,a.pointArray[i].y);b.stroke();b.beginPath();b.strokeStyle="rgba(100, 200, 240, 0.1)";for(i=0;i<a.pointArray.length;i++)b.lineTo(a.pointArray2[i].x,a.pointArray2[i].y);b.stroke();b.lineWidth=5;b.beginPath();b.strokeStyle="rgba(200, 80, 240, 0.2)";for(i=0;i<a.pointArray.length;i++)b.lineTo(a.pointArray3[i].x,a.pointArray3[i].y);
b.stroke();b.lineWidth=5;b.beginPath();b.strokeStyle="rgba(10, 20, 240, 0.2)";for(i=0;i<a.pointArray.length;i++)b.lineTo(a.pointArray4[i].x,a.pointArray4[i].y);b.stroke();b.lineWidth=3;b.beginPath();b.strokeStyle="rgba(240, 20, 20, 0.3)";for(i=0;i<a.pointArray.length;i++)b.lineTo(a.pointArray5[i].x,a.pointArray5[i].y)}b.stroke();"playing"==NumberMaze.State.inGameState&&"practise"!=NumberMaze.State.gameMode&&(b.font="bold "+(15-(12<a.scoreRef.chkPointRemain?12:a.scoreRef.chkPointRemain))*g.gameWidth/
128+"px Iceberg",b.fillStyle="rgba("+(255-10*a.scoreRef.chkPointRemain).toFixed(0)+", 100, 100, 0.8)",b.fillText(a.scoreRef.chkPointRemain.toFixed(2),a.pointArray[e].x+20,a.pointArray[e].y+30));b.globalCompositeOperation="source-over"};this.reset()}})();(function(){NumberMaze.GridLayer=function(e){var a=this,b=NumberMaze.State;this.delegate=null;var h=0,k=0;this.letterArray=[];this.targetArray=[12];this.targetIndex=0;var g,f,m,i,n,c=e.assetManager.Get("asteroidSprite");this.spriteData=e.assetManager.Get("spriteData");console.log(this.spriteData);var l=this.spriteData.frames[50].frame,q=0,u=1.5;this.getNextLetter=function(){targetIndex++;return a.targetArray[targetIndex]};this.mousemove=function(){};this.getCurrentTarget=function(){return a.targetArray[targetIndex]};
this.reset=function(){n=b.rowCount*b.colCount;q=m=m=i=targetIndex=0;a.letterArray=[];for(var c=0;c<n;c++)e=Math.floor(c/b.colCount),j=Math.floor(c%b.colCount),e=new NumberMaze.LetterSprite(c,0,0,e,j),this.letterArray.push(e);for(var e=0;e<n;e++)a.targetArray[e]=e,a.letterArray[e].reset();for(e=0;e<n;e++){var c=Math.round(Math.random()*(n-1)),h;h=a.targetArray[e];a.targetArray[e]=a.targetArray[c];a.targetArray[c]=h}a.letterArray[a.targetArray[targetIndex]].open();i=a.targetArray[targetIndex];m=a.targetArray[targetIndex];
g.arcLength=Math.PI;f.arcLength=Math.PI;this.delegate.practice.OnGameStart(g)};this.resizeLayout=function(c,e){h=c/(b.colCount+1);k=e/(b.rowCount+2);for(var i=0;i<n;i++){var q=Math.floor(i/b.colCount);a.letterArray[i].x=h*(i%b.colCount)+h;a.letterArray[i].y=k*q+k+0.15*e;a.letterArray[i].resizeLayout(c,e)}g.x=0.07*b.gameWidth;g.y=0.2*b.gameHeight;f.x=0.94*b.gameWidth;f.y=0.94*b.gameHeight};this.collidesWith=function(c){if("ending"==b.inGameState){if(Math.dist({x:f.x,y:f.y},c)<f.radius){for(var g=0;g<
n;g++)a.letterArray[g].open();a.delegate.touchedAllPoints()}}else{b.checkLine=!0;for(g=0;g<n;g++){var e,h;e=Math.floor(g/b.colCount);h=Math.floor(g%b.colCount);if(Math.dist({x:a.letterArray[g].x,y:a.letterArray[g].y},c)<a.letterArray[g].radius){1==b.gridStatus[e][h]?(a.letterArray[g].jingle(),a.delegate&&a.delegate.touchedTargetPoint(),targetIndex==n-1?(targetIndex++,console.log("changed to ending"),b.inGameState="ending",f.open(),this.delegate.practice.OnAllCrossed(f)):(console.log("gettin next letter"),
i=m,m=a.getNextLetter(),console.log(m),this.delegate.practice.OnLineCrossed(a.letterArray[m]),a.letterArray[m].open())):0==b.gridStatus[e][h]?(a.letterArray[g].explode(),a.delegate&&(a.delegate.touchedWrongPoint(),window.setTimeout(a.delegate.wrongPointExploded,1400))):g!=i?(console.log("outta"),console.log(g),console.log(i),a.letterArray[g].explode(),a.delegate&&(a.delegate.touchedWrongPoint(),window.setTimeout(a.delegate.wrongPointExploded,1400))):g==i&&(b.checkLine=!1);break}}}};this.update=function(c){if("ending"==
b.inGameState)f.update(3*c);else for(var g=0;g<n;g++)a.letterArray[g].update(c);"ending"==b.inGameState&&(q+=u,8<Math.abs(q)&&(u*=-1))};this.draw=function(g){g.fillStyle="rgba(50, 50, 90, 0.2)";g.strokeStyle="rgba(50, 50, 020, 0.8)";g.lineWidth=h/70;index=a.targetArray[targetIndex];for(var e=0;e<n;e++)if(e!=index){var i=a.spriteData.frames[a.letterArray[e].frame].frame;33>a.letterArray[e].frame?g.drawImage(c,i.x,i.y,i.w,i.h,a.letterArray[e].x-25*b.gameWidth/640,a.letterArray[e].y-25*b.gameHeight/
480,0.5*i.w*b.gameWidth/640,0.5*i.h*b.gameHeight/480):g.drawImage(c,i.x,i.y,i.w,i.h,a.letterArray[e].x-25*b.gameWidth/640,a.letterArray[e].y-25*b.gameHeight/480,i.w*b.gameWidth/640,i.h*b.gameHeight/480)}targetIndex!=n&&(i=a.spriteData.frames[a.letterArray[index].frame].frame,g.drawImage(c,i.x,i.y,i.w,i.h,a.letterArray[index].x-25*b.gameWidth/640,a.letterArray[index].y-25*b.gameHeight/480,0.5*i.w*b.gameWidth/640,0.5*i.h*b.gameHeight/480),g.globalCompositeOperation="lighter",g.drawImage(c,i.x,i.y,i.w,
i.h,a.letterArray[index].x-25*b.gameWidth/640,a.letterArray[index].y-25*b.gameHeight/480,0.5*i.w*b.gameWidth/640,0.5*i.h*b.gameHeight/480),g.drawImage(c,i.x,i.y,i.w,i.h,a.letterArray[index].x-25*b.gameWidth/640,a.letterArray[index].y-25*b.gameHeight/480,0.5*i.w*b.gameWidth/640,0.5*i.h*b.gameHeight/480),g.drawImage(c,i.x,i.y,i.w,i.h,a.letterArray[index].x-25*b.gameWidth/640,a.letterArray[index].y-25*b.gameHeight/480,0.5*i.w*b.gameWidth/640,0.5*i.h*b.gameHeight/480),g.globalCompositeOperation="source-over");
g.drawImage(c,l.x,l.y,l.w,l.h,f.x-l.w/2,f.y-l.h/2,(l.w+q)*b.gameWidth/640,(l.h+q)*b.gameHeight/480)};this.getStartLocation=function(){return{x:g.x,y:g.y}};g=new NumberMaze.LetterSprite(".",0.07*b.gameWidth,0.2*b.gameHeight,0,0);g.radius=8;f=new NumberMaze.LetterSprite(".",0.94*b.gameWidth,0.94*b.gameHeight,0,0);f.radius=8;this.resizeLayout(e.gameCanvas.width,e.gameCanvas.height)}})();(function(){NumberMaze.HUDLayer=function(e){var a=this,b=0,h=0;e.assetManager.Get("asteroidSprite");var k=e.assetManager.Get("spriteData").frames[51].frame;this.delegate=null;this.reset=function(){};this.mousedown=function(g,f){Math.dist({x:g,y:f},{x:0.96*b,y:0.5*h})<k.w/2&&a.delegate.pauseButtonPressed()};this.resizeLayout=function(a,f){b=a-4;h=0.1*f};this.update=function(){};this.draw=function(a){a.fillText("Level "+NumberMaze.State.currentLevel,0.1*b,h)};this.resizeLayout(e.gameCanvas.width,e.gameCanvas.height)}})();(function(){NumberMaze.Score=function(){var e=this,a=NumberMaze.State;this.chkPointRemain=this.totalScore=0;this.reset=function(){e.chkPointRemain=10;e.totalScore=0};this.targetTouched=function(){var b=Math.random()*(1-a.currentLevel/4)+(2-a.currentLevel/4);e.chkPointRemain+=b;return b};this.getLevelBonus=function(a){return 8+2*a};this.update=function(b){a.elapsedTime+=b;e.chkPointRemain-=b;0>=e.chkPointRemain&&e.delegate&&e.delegate.timeOut()};this.reset()}})();(function(){NumberMaze.CoreEngine=function(e){var a=this,b=NumberMaze.State;this.grid=new NumberMaze.GridLayer(e);this.grid.delegate=a;var h=new NumberMaze.GameLine(e);h.delegate=a;this.hud=new NumberMaze.HUDLayer(e);this.hud.delegate=e.uiManager;var k=new NumberMaze.Score(e);k.delegate=a;this.practice=new NumberMaze.PracticeGame(e);this.practice.delegate=a;var g=!1,f=0,m=1,i=0;this.craftSprite=e.assetManager.Get("craft");this.craftSpriteFrame=e.assetManager.Get("spriteData").frames[53].frame;var n=
0.8*a.craftSprite.width,c=0.8*a.craftSprite.height,l=1.02;this.getStartLocation=function(){return a.grid.getStartLocation()};this.getScore=function(){return k.totalScore+k.chkPointRemain};this.getLevelScore=function(){return k.chkPointRemain};this.getBonusScore=function(){return k.getLevelBonus(b.currentLevel)};this.reset=function(){b.inGameState="waiting";b.currentLevel=1;b.gridStatus=[];n=0.6*a.craftSprite.width;c=0.6*a.craftSprite.height;b.rowCount="practise"==b.gameMode?2:3;b.colCount=3;k.delegate=
"practise"==b.gameMode?null:a;for(var f=0;f<b.rowCount;f++){b.gridStatus[f]=[];for(var g=0;g<b.colCount;g++)b.gridStatus[f][g]=0}h.reset();a.grid.reset();a.hud.reset();k.reset();b.active=!0;a.firstWaitingProcc=!1;a.resizeLayout(e.gameCanvas.width,e.gameCanvas.height)};this.mousemove=function(c,b){a.grid.mousemove(c,b)};this.getGrid=function(){return a.grid};this.nextLevel=function(){b.inGameState="waiting";b.gridStatus=[];for(var c=0;c<b.rowCount;c++){b.gridStatus[c]=[];for(var f=0;f<b.colCount;f++)b.gridStatus[c][f]=
0}h.reset();a.grid.reset();a.hud.reset();k.chkPointRemain=12-b.currentLevel*("easy"==b.gameMode?1:2);b.active=!0;a.resizeLayout(b.gameWidth,b.gameHeight);a.firstWaitingProcc=!1};this.resizeLayout=function(c,b){a.grid.resizeLayout(c,b);h.resizeLayout(c,b);a.hud.resizeLayout(c,b);this.practice.resizeLayout(c,b)};this.addPoint=function(c,f){if(b.active){var g={x:c,y:f};h.addPoint(c,f)&&a.grid.collidesWith(g)&&console.log("collision detected");a.hud.mousedown(c,f)}};this.update=function(f){a.grid.update(f);
h.update(f);"playing"==b.inGameState&&"practise"!=b.gameMode&&(k.update(f),a.hud.update(f,k.chkPointRemain,0));var g=h.pointArray.length-1;3<g&&(g=Math.atan2(h.pointArray[g].y-h.pointArray[g-1].y,h.pointArray[g].x-h.pointArray[g-1].x),g-i>22/7&&(g-=2*(22/7)),g-i<-22/7&&(g+=2*(22/7)),i+=(g-i)/2);if("waiting"==b.inGameState){if(n>0.9*a.craftSprite.width||n<0.6*a.craftSprite.width)l=1/l;n*=l;c*=l}else"practise"==b.gameMode&&this.practice.update(f);"waiting"!=b.inGameState&&!0!=a.firstWaitingProcc&&(a.practice.OnFirstClick(a.grid.letterArray[a.grid.getCurrentTarget()]),
a.firstWaitingProcc=!0)};this.draw=function(e){var l=h.pointArray.length-1;a.grid.draw(e);h.draw(e);e.font="bold "+Math.round(b.gameWidth/32)+"px Iceberg";a.hud.draw(e);e.save();e.translate(h.pointArray[l].x,h.pointArray[l].y);e.rotate(i+1.57);"exploding"==b.inGameState&&(n*=0.9,c*=0.9,i+=Math.round(Math.random()/6));e.drawImage(a.craftSprite,0.5*-n*b.gameWidth/640,0.5*-c*b.gameHeight/480,n*b.gameWidth/640,c*b.gameHeight/480);e.restore();g&&(l=h.pointArray.length-1,e.fillStyle="rgba(200, 150, 150, "+
m+")",e.font="bold "+(15-k.chkPointRemain)*b.gameWidth/128+"px Iceberg",e.fillText(f.toFixed(2),h.pointArray[l].x+20,h.pointArray[l].y-50*(1-m)),m-=0.04,0>=m&&(g=!1));"practise"==b.gameMode&&(e.font="bold "+Math.round(b.gameWidth/48)+"px Iceberg",e.fillStyle="rgba(20, 20, 20, 0.9)",this.practice.draw(e))};this.lineTouched=function(){b.soundOn&&e.assetManager.Get("touchLineA").play();b.inGameState="exploding";b.active=!1};this.lineExploded=function(){b.inGameState="lose";a.delegate.gameOver()};this.touchedTargetPoint=
function(){b.soundOn&&e.assetManager.Get("targetTouchA").play();f=k.targetTouched();g=!0;m=1};this.touchedWrongPoint=function(){b.soundOn&&e.assetManager.Get("explosionA").play();b.inGameState="exploding";b.active=!1};this.wrongPointExploded=function(){b.inGameState="lose";a.delegate.gameOver()};this.touchedAllPoints=function(){b.soundOn&&e.assetManager.Get("levelWinA").play();b.currentLevel++;b.inGameState="won";window.setTimeout(a.delegate.gameWon,2E3);window.setTimeout(a.updateScore,2100)};this.timeOut=
function(){b.inGameState="lose";b.active=!1;window.setTimeout(a.delegate.gameOver,1E3)};this.gameTimeOut=function(){};this.updateScore=function(){k.totalScore+=k.chkPointRemain+k.getLevelBonus(b.currentLevel)};this.reset();h.scoreRef=k}})();(function(){NumberMaze.MainMenu=function(e){var a=this,b,h,k=0,g=0,f=new NumberMaze.MenuButton("new game",0.5,0.4,0.25,0.1);f.delegate=a;var m=new NumberMaze.MenuButton("easy",0.8,0.4,0.25,0.1);m.delegate=a;var i=new NumberMaze.MenuButton("hard",0.8,0.5,0.25,0.1);i.delegate=a;(new NumberMaze.MenuButton("score board",0.6,0.6,0.25,0.1)).delegate=a;var n=new NumberMaze.MenuButton("tutorial",0.5,0.55,0.25,0.1);n.delegate=a;var c=new NumberMaze.MenuButton("credits",0.5,0.7,0.25,0.1);c.delegate=a;var l=
new NumberMaze.MenuButton("feedback",0.2,0.96,0.2,0.08);l.delegate=a;this.addPoint=function(c,b){var f={x:c,y:b};1<a.pointArray.length?3<Math.dist(f,a.pointArray[a.pointArray.length-1])&&(a.pointArray.push(f),a.pointArray1.push({x:c+5*Math.random()-2.5,y:b+5*Math.random()-2.5}),a.pointArray2.push({x:c+5*Math.random()-2.5,y:b+5*Math.random()-2.5})):(a.pointArray.push(f),a.pointArray1.push(f),a.pointArray2.push(f))};this.mouseup=function(a,g){f.mouseup(a,g);c.mouseup(a,g);n.mouseup(a,g);l.mouseup(a,
g);b&&(m.mouseup(a,g),i.mouseup(a,g))};this.mousemove=function(g,e){a.addPoint(g,e);f.mousemove(g,e);c.mousemove(g,e);n.mousemove(g,e);l.mousemove(g,e);b&&(m.mousemove(g,e),i.mousemove(g,e))};this.click=function(g){g==f?b=!b:g==m?a.delegate.mainMenuNewGameEasy():g==i?a.delegate.mainMenuNewGameHard():g==n?a.delegate.mainMenuNewGamePractice():g==c?a.delegate.mainMenuCredits():g==l&&window.open("https://docs.google.com/spreadsheet/viewform?formkey=dG8yUVdiNngyOGZRMkZrZHd1Skx1VlE6MQ","_blank")};this.reset=
function(){h=0;b=!1;a.pointArray=[];a.pointArray1=[];a.pointArray2=[]};this.resizeLayout=function(a,b){k=a;g=b;f.resizeLayout(a,b);c.resizeLayout(a,b);n.resizeLayout(a,b);m.resizeLayout(a,b);i.resizeLayout(a,b);l.resizeLayout(a,b)};this.update=function(b){h+=b;h>0.4-a.pointArray.length/20&&(a.pointArray.shift(),a.pointArray1.shift(),a.pointArray2.shift(),h=0);f.update(b);c.update(b);l.update(b)};this.draw=function(e){e.textBaseLine="middle";e.textAlign="center";e.fillStyle="rgba(220, 220, 220, 0.8)";
e.font="bold "+k/16+"px Geostar Fill";var h=e.shadowColor;e.shadowColor="#d88";e.shadowOffsetX=0;e.shadowOffsetY=0;e.shadowBlur=30;e.fillText("HTML5 Space Maze",k/2,0.12*g);e.fillText("(BETA)",k/2,0.2*g);e.shadowColor=h;e.lineWidth=k/100;e.lineCap="round";e.fillStyle="rgbaw210, 200, 200, 0.8)";h=e.globalCompositeOperation;e.globalCompositeOperation="lighter";if(0<a.pointArray.length){e.strokeStyle="rgba(255, 55, 55, 0.4)";e.beginPath();e.moveTo(a.pointArray[0].x,a.pointArray[0].y);for(var s=1;s<a.pointArray.length;s++)e.lineTo(a.pointArray[s].x,
a.pointArray[s].y);e.stroke();e.closePath();e.strokeStyle="rgba(55, 255, 55, 0.4)";e.beginPath();e.moveTo(a.pointArray1[0].x,a.pointArray1[0].y);for(s=1;s<a.pointArray.length;s++)e.lineTo(a.pointArray1[s].x,a.pointArray1[s].y);e.stroke();e.closePath();e.strokeStyle="rgba(255, 55, 55, 0.4)";e.beginPath();e.moveTo(a.pointArray2[0].x,a.pointArray2[0].y);for(s=1;s<a.pointArray.length;s++)e.lineTo(a.pointArray2[s].x,a.pointArray2[s].y);e.stroke();e.closePath()}e.globalCompositeOperation=h;e.strokeStyle=
"rgba(255, 255, 255, 0.2)";e.font=k/26+"px Iceberg";f.draw(e);c.draw(e);n.draw(e);l.draw(e);b&&(m.draw(e),i.draw(e))};a.reset();this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.Credits=function(e){var a=this,b=0,h=0,k=new NumberMaze.MenuButton("back",0.1,0.06,0.2,0.1);k.delegate=a;this.mouseup=function(a,b){k.mouseup(a,b)};this.mousemove=function(a,b){k.mousemove(a,b)};this.click=function(b){b==k&&a.delegate.creditsBack()};this.reset=function(){};this.resizeLayout=function(a,f){b=a;h=f;k.resizeLayout(a,f)};this.update=function(a){k.update(a)};this.draw=function(a){a.textBaseLine="middle";a.textAlign="center";a.fillStyle="rgba(220, 220, 220, 0.8)";
a.font="bold "+b/20+"px Geostar Fill";var f=a.shadowColor;a.shadowColor="#d88";a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=30;a.fillText("Credits",b/2,0.1*h);a.shadowColor=f;a.font=b/30+"px Iceberg";k.draw(a)};this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.LBoard=function(e){var a=this;a.scoreList=[];var b=NumberMaze.State,h="easy",k=0,g=0,f=new NumberMaze.MenuButton("back",0.1,0.06,0.2,0.1);f.delegate=a;var m=new NumberMaze.MenuButton("easy",0.35,0.9,0.2,0.1);m.delegate=a;var i=new NumberMaze.MenuButton("hard",0.65,0.9,0.2,0.1);i.delegate=a;this.mouseup=function(a,c){f.mouseup(a,c);m.mouseup(a,c);i.mouseup(a,c)};this.mousemove=function(a,c){f.mousemove(a,c);m.mousemove(a,c);i.mousemove(a,c)};this.click=function(b){b==f?a.delegate.LBoardBack():
b==m?(h="easy",a.reset()):b==i&&(h="hard",a.reset())};this.reset=function(){console.log(h+"-"+(b.isMobile?"mobile":"normal"))};this.resizeLayout=function(a,c){k=a;g=c;f.resizeLayout(a,c);m.resizeLayout(a,c);i.resizeLayout(a,c)};this.update=function(a){f.update(a);m.update(a);i.update(a)};this.draw=function(b){b.textBaseLine="middle";b.textAlign="center";b.fillStyle="rgba(220, 220, 220, 0.8)";b.font="bold "+k/20+"px Geostar Fill";var c=b.shadowColor;b.shadowColor="#d88";b.shadowOffsetX=0;b.shadowOffsetY=
0;b.shadowBlur=30;b.fillText("Leader Boards",k/2,0.1*g);b.shadowColor=c;b.font=k/32+"px Icerberg";b.textAlign="left";for(c=0;c<Math.min(a.scoreList.length,10);c++){var e=a.scoreList[c];b.fillText(c+1,0.1*k,100+30*c);b.fillText(e.Name,0.2*k,100+30*c);b.fillText(e.Points,0.8*k,100+30*c)}b.font=k/30+"px Iceberg";b.textAlign="center";f.draw(b);m.draw(b);i.draw(b)};this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.PauseScreen=function(e){var a=this,b=0,h=0,k=new NumberMaze.MenuButton("resume",0.3,0.75,0.2,0.1);k.delegate=a;var g=new NumberMaze.MenuButton("restart",0.7,0.75,0.2,0.1);g.delegate=a;var f=new NumberMaze.MenuButton("help",0.3,0.9,0.2,0.1);f.delegate=a;var m=new NumberMaze.MenuButton("quit",0.7,0.9,0.2,0.1);m.delegate=a;this.mouseup=function(a,b){k.mouseup(a,b);g.mouseup(a,b);f.mouseup(a,b);m.mouseup(a,b)};this.mousemove=function(a,b){k.mousemove(a,b);g.mousemove(a,b);f.mousemove(a,
b);m.mousemove(a,b)};this.click=function(b){b==k?a.delegate.pauseScreenResume():b==g?a.delegate.pauseScreenRestart():b==f?a.delegate.pauseScreenHelp():b==m&&a.delegate.pauseScreenQuit()};this.resizeLayout=function(a,e){b=0.96*a;h=0.96*e;k.resizeLayout(a,e);g.resizeLayout(a,e);f.resizeLayout(a,e);m.resizeLayout(a,e)};this.update=function(a){k.update(a);g.update(a);f.update(a);m.update(a)};this.draw=function(a){a.fillStyle="rgba(100, 100, 100, 0.3)";a.fillRect(0.02*b,0.02*h,b,0.65*h);a.textBaseLine=
"middle";a.textAlign="center";a.fillStyle="rgba(220, 220, 220, 0.8)";a.font="bold "+b/20+"px Geostar Fill";var e=a.shadowColor;a.shadowColor="#d88";a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=30;a.fillText("Game Paused",b/2,0.1*h);a.shadowColor=e;a.font=b/30+"px Iceberg";k.draw(a);g.draw(a);f.draw(a);m.draw(a)};this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.GameOver=function(e){var a=this,b=this.lvlScore=this.score=0,h=0,k=new NumberMaze.MenuButton("restart",0.25,0.9,0.2,0.1);k.delegate=a;var g=new NumberMaze.MenuButton("quit",0.75,0.9,0.2,0.1);g.delegate=a;var f=new NumberMaze.MenuButton("tutorial",0.5,0.9,0.2,0.1);f.delegate=a;this.mouseup=function(a,b){k.mouseup(a,b);g.mouseup(a,b);f.mouseup(a,b)};this.mousemove=function(a,b){k.mousemove(a,b);g.mousemove(a,b);f.mousemove(a,b)};this.click=function(b){b==k?a.delegate.pauseScreenRestart():
b==g?a.delegate.pauseScreenQuit():b==f&&1==NumberMaze.State.currentLevel&&a.delegate.mainMenuNewGamePractice()};this.resizeLayout=function(a,e){b=0.96*a;h=0.96*e;k.resizeLayout(a,e);g.resizeLayout(a,e);f.resizeLayout(a,e)};this.update=function(a){k.update(a);g.update(a);f.update(a)};this.draw=function(e){e.fillStyle="rgba(100, 100, 100, 0.3)";e.fillRect(0.02*b,0.02*h,b,0.8*h);e.textBaseLine="middle";e.textAlign="center";e.fillStyle="rgba(220, 220, 220, 0.8)";e.font="bold "+b/20+"px Geostar Fill";
var i=e.shadowColor;e.shadowColor="#d88";e.shadowOffsetX=0;e.shadowOffsetY=0;e.shadowBlur=30;e.fillText("Game Over",b/2,0.1*h);e.shadowColor=i;e.font=b/28+"px Iceberg";e.textAlign="left";e.fillText("Level "+parseInt(NumberMaze.State.currentLevel)+" score is ",0.25*b,0.3*h);e.fillText(Math.round(a.lvlScore),0.7*b,0.3*h);e.fillText("Your score is ",0.25*b,0.4*h);e.fillText(Math.round(a.score+a.lvlScore),0.7*b,0.4*h);e.textAlign="center";NumberMaze.State.fbLoggedin?e.fillText("Status : "+NumberMaze.State.fbShareStatus,
0.5*b,0.75*h):e.fillText("Please login to submit score to leaderboard",0.5*b,0.65*h);e.font=b/30+"px Iceberg";k.draw(e);g.draw(e);1==NumberMaze.State.currentLevel&&f.draw(e)};this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.WonScreen=function(e){var a=this,b=this.bonus=this.lvlScore=this.score=0,h=0,k=new NumberMaze.MenuButton("next",0.3,0.9,0.2,0.1);k.delegate=a;var g=new NumberMaze.MenuButton("quit",0.7,0.9,0.2,0.1);g.delegate=a;this.mouseup=function(a,b){k.mouseup(a,b);g.mouseup(a,b)};this.mousemove=function(a,b){k.mousemove(a,b);g.mousemove(a,b)};this.click=function(b){b==k?a.delegate.gWonScreenNext():b==g&&a.delegate.gWonScreenQuit()};this.resizeLayout=function(a,e){b=0.96*a;h=0.96*e;k.resizeLayout(a,
e);g.resizeLayout(a,e)};this.update=function(a){k.update(a);g.update(a)};this.draw=function(f){f.fillStyle="rgba(100, 100, 100, 0.3)";f.fillRect(0.02*b,0.02*h,b,0.8*h);f.textBaseLine="middle";f.textAlign="center";f.fillStyle="rgba(220, 220, 220, 0.8)";f.font="bold "+b/20+"px Geostar Fill";var e=f.shadowColor;f.shadowColor="#d88";f.shadowOffsetX=0;f.shadowOffsetY=0;f.shadowBlur=30;f.fillText("Game Won",b/2,0.1*h);f.shadowColor=e;f.font=b/28+"px Iceberg";f.textAlign="left";f.fillText("Level "+parseInt(NumberMaze.State.currentLevel-
1)+" highest score is ",0.25*b,0.3*h);f.fillText(Math.round(a.lvlScore),0.7*b,0.3*h);f.fillText("Bonus score is ",0.25*b,0.4*h);f.fillText(Math.round(a.bonus),0.7*b,0.4*h);f.fillText("Your score is ",0.25*b,0.5*h);f.fillText(Math.round(a.score+a.lvlScore+a.bonus),0.7*b,0.5*h);f.textAlign="center";""==NumberMaze.State.authProvider&&f.fillText("Please login to submit score to leaderboard",0.5*b,0.65*h);f.font=b/30+"px Iceberg";k.draw(f);g.draw(f)};this.resizeLayout(e.menuCanvas.width,e.menuCanvas.height)}})();(function(){NumberMaze.MenuButton=function(e,a,b,h,k){var g=this;this.text=e;this.x=a;this.y=b;this.width=h;this.height=k;var f=0,m=0,i=0,n=0,c=0,l=0,q=!1;this.resizeLayout=function(a,b){i=a*g.x;n=b*g.y;c=a*g.width;l=b*g.height};this.print=function(){console.log("x: "+i+", y: "+n+", width: "+c+", height: "+l)};this.reset=function(){f=0;m=g.height/2;arcLength=Math.PI/4};this.mouseup=function(a,b){a>i-c/2&&(a<i+c/2&&b>n-l/2&&b<n+l/2)&&(NumberMaze.State.soundOn&&game.assetManager.Get("clickA").play(),
g.delegate.click(g))};this.mousemove=function(a,b){q=a>i-c/2&&a<i+c/2&&b>n-l/2&&b<n+l/2?!0:!1};this.update=function(){};this.draw=function(a){a.beginPath();a.fillStyle=q?"rgba(110, 150, 250, 0.3)":"rgba(110, 150, 250, 0.2)";a.rect(i-c/2,n-l/2,c,l);a.fill();a.closePath();a.beginPath();a.rect(i-c/2,n+0.3*l,c,0.2*l);a.fill();a.fillStyle="rgba(210, 150, 150, 0.8)";a.fillText(g.text,i+f,n+m);a.closePath()};this.reset()}})();(function(e){NumberMaze.PracticeGame=function(a){var b=0,h=0,k="",g=e,f=e;this.delegate=null;this.OnGameStart=function(a){g=a;f="GameStart";k="Click on the ship/n to start the game."};this.OnFirstClick=function(a){g=a;f="FirstClick";k="Touch this asteroid/nDon't collide with/nyour own line!"};this.OnLineCrossed=function(a){"LineCrossed"!=f&&(g=a,f="LineCrossed",k="Now cross all asteroids/none by one reaching/nyour planet in the end")};this.OnAllCrossed=function(a){g=a;f="AllCrossed";k="Finish by reaching/nyour planet!"};
this.resizeLayout=function(a,f){b=a;h=f};this.update=function(){};this.draw=function(f){if(g!=e){var i=g.x,n=g.y;a.assetManager.Get("tooltip").width+g.x>a.gameCanvas.width&&(i=a.gameCanvas.width-a.assetManager.Get("tooltip").width);0>g.x&&(i=0);a.assetManager.Get("tooltip").height+g.y>a.gameCanvas.height&&(n=a.gameCanvas.height-a.assetManager.Get("tooltip").height);0>g.y&&(n=0);f.drawImage(a.assetManager.Get("tooltip"),i,n,164*b/640,82*h/480);for(var c=k.split("/n"),l=0;l<c.length;l++)f.fillText(c[l],
i+b/28,n+(l+1)*h/24+6)}}}})();(function(){NumberMaze.PractiseFail=function(e){var a=this,b=0,h=0,k=new NumberMaze.MenuButton("restart",0.25,0.9,0.2,0.1);k.delegate=a;var g=new NumberMaze.MenuButton("quit",0.75,0.9,0.2,0.1);g.delegate=a;this.mouseup=function(a,b){k.mouseup(a,b);g.mouseup(a,b)};this.mousemove=function(a,b){k.mousemove(a,b);g.mousemove(a,b)};this.click=function(b){b==k?a.delegate.pauseScreenRestart():b==g&&a.delegate.pauseScreenQuit()};this.resizeLayout=function(a,e){b=0.96*a;h=0.96*e;k.resizeLayout(a,e);g.resizeLayout(a,
e)};this.update=function(a){k.update(a);g.update(a)};this.draw=function(a){a.fillStyle="rgba(100, 100, 100, 0.3)";a.fillRect(0.02*b,0.02*h,b,0.8*h);a.textBaseLine="middle";a.textAlign="center";a.fillStyle="rgba(220, 220, 220, 0.8)";a.font="bold "+b/20+"px Geostar Fill";var e=a.shadowColor;a.shadowColor="#d88";a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=30;a.fillText("PRACTISE FAILURE",b/2,0.1*h);a.shadowColor=e;a.font=b/30+"px Iceberg";k.draw(a);g.draw(a)};this.resizeLayout(e.menuCanvas.width,
e.menuCanvas.height)}})();
